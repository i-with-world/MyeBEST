###############################################################################
#                                                                             #
#                                                       10/Jan/2013  19:05:42 #
# IAR ANSI C/C++ Compiler V6.30.6.23336/W32 EVALUATION for ARM                #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Library\D #
#                    rivers\PIT\pit.c                                         #
#    Command line =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Library\D #
#                    rivers\PIT\pit.c -D IAR -lCN                             #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Debug\Lis #
#                    t\ -lB E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ #
#                    °Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\De #
#                    bug\List\ -o E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì× #
#                    ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0. #
#                    0.3\Debug\Obj\ --no_cse --no_unroll --no_inline          #
#                    --no_code_motion --no_tbaa --no_clustering               #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M4  #
#                    -e --fpu=None --dlib_config                              #
#                    D:\Tools\IAR6.30\arm\INC\c\DLib_Config_Normal.h -I       #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Library\C #
#                    PU\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ #
#                    °Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Li #
#                    brary\Drivers\ADC\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁ #
#                    Ï\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\201 #
#                    30110\V0.0.3\Library\Drivers\FTM\ -I                     #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Library\D #
#                    rivers\GPIO\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë #
#                    ½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\ #
#                    V0.0.3\Library\Drivers\PIT\ -Ol                          #
#    List file    =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Debug\Lis #
#                    t\pit.lst                                                #
#    Object file  =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Debug\Obj #
#                    \pit.o                                                   #
#                                                                             #
#                                                                             #
###############################################################################

E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130110\V0.0.3\Library\Drivers\PIT\pit.c
      1          /*******************************************************************************
      2          * ÎÄ¼þÃû³Æ£ºpit.c
      3          * Ãè    Êö: PIT(ÖÜÆÚ¶¨Ê±ÖÐ¶Ï)Çý¶¯³ÌÐò
      4          * ×÷    Õß£ºÍò±ù±ù
      5          * ÌØ±ðÃùÐ»£º¼Í³ÉÊ¦ÐÖ(²©¿Íhttp://blog.chinaaet.com/jihceng0622)
      6          * Ê±    ¼ä£º2012Äê5ÔÂ21ÈÕ
      7          *******************************************************************************/
      8          
      9          #include "pit.h"
     10          
     11          
     12          /*******************************************************************************
     13          * º¯ÊýÃû³Æ£ºPIT_setIntTime
     14          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     15                              TIMER0
     16                              TIMER1
     17                              TIMER2
     18                              TIMER3
     19                      time   ¶¨Ê±Ê±¼ä,µ¥Î» us
     20                      pie    ÖÐ¶ÏÊ¹ÄÜÑ¡Ôñ
     21                      prio   ÖÐ¶ÏÓÅÏÈ¼¶(È¡Öµ0-15,ÖµÔ½Ð¡ÓÅÏÈ¼¶Ô½¸ß)
     22          * Ãè    Êö£ºÉèÖÃ¶¨Ê±Æ÷
     23          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     24          void PIT_setTime(int8u_t timer, int32u_t time, int8u_t pie, int8u_t prio)
     25          {
   \                     PIT_setTime:
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x001D             MOVS     R5,R3
     26            SIM_SCGC6 |= SIM_SCGC6_PIT_MASK;               // ´ò¿ª PIT Ê±ÖÓ 
   \   00000006   0x....             LDR.N    R0,??DataTable4  ;; 0x4004803c
   \   00000008   0x6800             LDR      R0,[R0, #+0]
   \   0000000A   0xF450 0x0000      ORRS     R0,R0,#0x800000
   \   0000000E   0x....             LDR.N    R3,??DataTable4  ;; 0x4004803c
   \   00000010   0x6018             STR      R0,[R3, #+0]
     27            PIT_TCTRL(timer) &= ~PIT_TCTRL_TEN_MASK;       // Í£Ö¹¶¨Ê±
   \   00000012   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000014   0x....             LDR.N    R0,??DataTable4_1  ;; 0x40037100
   \   00000016   0xEB10 0x1004      ADDS     R0,R0,R4, LSL #+4
   \   0000001A   0x6880             LDR      R0,[R0, #+8]
   \   0000001C   0x0840             LSRS     R0,R0,#+1
   \   0000001E   0x0040             LSLS     R0,R0,#+1
   \   00000020   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000022   0x....             LDR.N    R3,??DataTable4_1  ;; 0x40037100
   \   00000024   0xEB13 0x1304      ADDS     R3,R3,R4, LSL #+4
   \   00000028   0x6098             STR      R0,[R3, #+8]
     28            PIT_MCR = 0x00;                                // Ê¹ÄÜPIT¹¦ÄÜ
   \   0000002A   0x....             LDR.N    R0,??DataTable4_2  ;; 0x40037000
   \   0000002C   0x2300             MOVS     R3,#+0
   \   0000002E   0x6003             STR      R3,[R0, #+0]
     29            PIT_LDVAL(timer) = PIT_LDVAL_TSV(time*BUS_ClK);// ÉèÖÃ¶¨Ê±Ê±¼ä
   \   00000030   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000032   0x0120             LSLS     R0,R4,#+4
   \   00000034   0x....             LDR.N    R3,??DataTable4_1  ;; 0x40037100
   \   00000036   0x2630             MOVS     R6,#+48
   \   00000038   0x4371             MULS     R1,R6,R1
   \   0000003A   0x50C1             STR      R1,[R0, R3]
     30            if(pie == 1)
   \   0000003C   0xB2D2             UXTB     R2,R2            ;; ZeroExt  R2,R2,#+24,#+24
   \   0000003E   0x2A01             CMP      R2,#+1
   \   00000040   0xD118             BNE.N    ??PIT_setTime_0
     31            {
     32              EnableInt_Kinetis(68+timer);                 // ¿ªÆô¶ÔÓ¦µÄÖÐ¶Ï
   \   00000042   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000044   0xF114 0x0044      ADDS     R0,R4,#+68
   \   00000048   0x.... 0x....      BL       EnableInt_Kinetis
     33              SetIntPri_Kinetis(68+timer,prio);            // ÉèÖÃÖÐ¶ÏÓÅÏÈ¼¶
   \   0000004C   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   0000004E   0x0029             MOVS     R1,R5
   \   00000050   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000052   0xF114 0x0044      ADDS     R0,R4,#+68
   \   00000056   0x.... 0x....      BL       SetIntPri_Kinetis
     34              PIT_TCTRL(timer) |= PIT_TCTRL_TIE_MASK;      // Ê¹ÄÜ¶¨Ê±ÖÐ¶Ï
   \   0000005A   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000005C   0x....             LDR.N    R0,??DataTable4_1  ;; 0x40037100
   \   0000005E   0xEB10 0x1004      ADDS     R0,R0,R4, LSL #+4
   \   00000062   0x6880             LDR      R0,[R0, #+8]
   \   00000064   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   00000068   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000006A   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   0000006C   0xEB11 0x1104      ADDS     R1,R1,R4, LSL #+4
   \   00000070   0x6088             STR      R0,[R1, #+8]
   \   00000072   0xE00B             B.N      ??PIT_setTime_1
     35            }
     36            else
     37            {
     38              PIT_TCTRL(timer) &= ~PIT_TCTRL_TIE_MASK;     // ½ûÖ¹¶¨Ê±ÖÐ¶Ï
   \                     ??PIT_setTime_0:
   \   00000074   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000076   0x....             LDR.N    R0,??DataTable4_1  ;; 0x40037100
   \   00000078   0xEB10 0x1004      ADDS     R0,R0,R4, LSL #+4
   \   0000007C   0x6880             LDR      R0,[R0, #+8]
   \   0000007E   0xF030 0x0002      BICS     R0,R0,#0x2
   \   00000082   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000084   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000086   0xEB11 0x1104      ADDS     R1,R1,R4, LSL #+4
   \   0000008A   0x6088             STR      R0,[R1, #+8]
     39            }
     40            PIT_TCTRL(timer) |= PIT_TCTRL_TEN_MASK;        // ¿ªÊ¼¶¨Ê±
   \                     ??PIT_setTime_1:
   \   0000008C   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000008E   0x....             LDR.N    R0,??DataTable4_1  ;; 0x40037100
   \   00000090   0xEB10 0x1004      ADDS     R0,R0,R4, LSL #+4
   \   00000094   0x6880             LDR      R0,[R0, #+8]
   \   00000096   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   0000009A   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000009C   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   0000009E   0xEB11 0x1104      ADDS     R1,R1,R4, LSL #+4
   \   000000A2   0x6088             STR      R0,[R1, #+8]
     41          }
   \   000000A4   0xBD70             POP      {R4-R6,PC}       ;; return
     42          
     43          /*******************************************************************************
     44          * º¯ÊýÃû³Æ£ºPIT_start
     45          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     46                              TIMER0
     47                              TIMER1
     48                              TIMER2
     49                              TIMER3
     50          * Ãè    Êö£º¿ªÊ¼¶¨Ê±
     51          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     52          void PIT_start(int8u_t timer)
     53          {
     54            PIT_TCTRL(timer) |= PIT_TCTRL_TEN_MASK;        // ¿ªÊ¼¶¨Ê±
   \                     PIT_start:
   \   00000000   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000004   0xEB11 0x1100      ADDS     R1,R1,R0, LSL #+4
   \   00000008   0x6889             LDR      R1,[R1, #+8]
   \   0000000A   0xF051 0x0101      ORRS     R1,R1,#0x1
   \   0000000E   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000010   0x....             LDR.N    R2,??DataTable4_1  ;; 0x40037100
   \   00000012   0xEB12 0x1000      ADDS     R0,R2,R0, LSL #+4
   \   00000016   0x6081             STR      R1,[R0, #+8]
     55          }
   \   00000018   0x4770             BX       LR               ;; return
     56          
     57          /*******************************************************************************
     58          * º¯ÊýÃû³Æ£ºPIT_stop
     59          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     60                              TIMER0
     61                              TIMER1
     62                              TIMER2
     63                              TIMER3
     64          * Ãè    Êö£ºÍ£Ö¹¶¨Ê±
     65          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     66          void PIT_stop(int8u_t timer)
     67          {
     68            PIT_TCTRL(timer) &= ~PIT_TCTRL_TEN_MASK;      // Í£Ö¹¶¨Ê±
   \                     PIT_stop:
   \   00000000   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000004   0xEB11 0x1100      ADDS     R1,R1,R0, LSL #+4
   \   00000008   0x6889             LDR      R1,[R1, #+8]
   \   0000000A   0x0849             LSRS     R1,R1,#+1
   \   0000000C   0x0049             LSLS     R1,R1,#+1
   \   0000000E   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000010   0x....             LDR.N    R2,??DataTable4_1  ;; 0x40037100
   \   00000012   0xEB12 0x1000      ADDS     R0,R2,R0, LSL #+4
   \   00000016   0x6081             STR      R1,[R0, #+8]
     69          }
   \   00000018   0x4770             BX       LR               ;; return
     70           
     71          /*******************************************************************************
     72          * º¯ÊýÃû³Æ£ºPIT_stop
     73          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     74                              TIMER0
     75                              TIMER1
     76                              TIMER2
     77                              TIMER3
     78          * Ãè    Êö£ºÇåÁãÖÐ¶Ï±êÖ¾Î»
     79          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     80          void PIT_clearIntFlg(int8u_t timer)
     81          {
     82            PIT_TFLG(timer) = PIT_TFLG_TIF_MASK;         // ÇåÁãÖÐ¶Ï±êÖ¾Î»
   \                     PIT_clearIntFlg:
   \   00000000   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000004   0xEB11 0x1000      ADDS     R0,R1,R0, LSL #+4
   \   00000008   0x2101             MOVS     R1,#+1
   \   0000000A   0x60C1             STR      R1,[R0, #+12]
     83          }
   \   0000000C   0x4770             BX       LR               ;; return
     84          
     85          /*******************************************************************************
     86          * º¯ÊýÃû³Æ£ºPIT_readValue
     87          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     88                              TIMER0
     89                              TIMER1
     90                              TIMER2
     91                              TIMER3
     92                      result ¼ÆÊýÆ÷µ±Ç°ÊýÖµ
     93          * Ãè    Êö£º¶ÁÈ¡¼ÆÊýÆ÷µ±Ç°ÊýÖµ
     94          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     95          void PIT_readValue(int8u_t timer, int32u_t * result)
     96          {
     97            *result = PIT_CVAL(timer);
   \                     PIT_readValue:
   \   00000000   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   0x....             LDR.N    R2,??DataTable4_1  ;; 0x40037100
   \   00000004   0xEB12 0x1000      ADDS     R0,R2,R0, LSL #+4
   \   00000008   0x6840             LDR      R0,[R0, #+4]
   \   0000000A   0x6008             STR      R0,[R1, #+0]
     98          }
   \   0000000C   0x4770             BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   0x4004803C         DC32     0x4004803c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_1:
   \   00000000   0x40037100         DC32     0x40037100

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_2:
   \   00000000   0x40037000         DC32     0x40037000
     99          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        0  PIT_clearIntFlg
        0  PIT_readValue
       16  PIT_setTime
             16 -> EnableInt_Kinetis
             16 -> SetIntPri_Kinetis
        0  PIT_start
        0  PIT_stop


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable4
       4  ??DataTable4_1
       4  ??DataTable4_2
      14  PIT_clearIntFlg
      14  PIT_readValue
     166  PIT_setTime
      26  PIT_start
      26  PIT_stop

 
 258 bytes in section .text
 
 258 bytes of CODE memory

Errors: none
Warnings: none
