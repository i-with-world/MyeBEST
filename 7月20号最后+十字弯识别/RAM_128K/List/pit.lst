###############################################################################
#                                                                             #
#                                                       30/Oct/2014  20:23:35 #
# IAR ANSI C/C++ Compiler V6.30.6.23336/W32 EVALUATION for ARM                #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Library\Dr #
#                    ivers\PIT\pit.c                                          #
#    Command line =  E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Library\Dr #
#                    ivers\PIT\pit.c -D IAR -lCN                              #
#                    E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\RAM_128K\L #
#                    ist\ -lB E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\R #
#                    AM_128K\List\ -o E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029 #
#                    µ÷ÊÔ°æ\RAM_128K\Obj\ --debug --endian=little             #
#                    --cpu=Cortex-M4 -e --fpu=None --dlib_config "C:\Program  #
#                    Files\IAR Systems\Embedded Workbench 6.0                 #
#                    Evaluation\arm\INC\c\DLib_Config_Normal.h" -I            #
#                    E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Library\CP #
#                    U\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Libr #
#                    ary\Drivers\ADC\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1 #
#                    029µ÷ÊÔ°æ\Library\Drivers\FTM\ -I                        #
#                    E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Library\Dr #
#                    ivers\GPIO\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ #
#                    ÊÔ°æ\Library\Drivers\PIT\ -I                             #
#                    E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\System_Ini #
#                    t\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Sour #
#                    ce\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\OLE #
#                    D\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\SD_S #
#                    ystem\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\ #
#                    Simple_AD\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷Ê #
#                    Ô°æ\Delay\ -I E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷Ê #
#                    Ô°æ\Make_Desicion\ -Oh                                   #
#    List file    =  E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\RAM_128K\L #
#                    ist\pit.lst                                              #
#    Object file  =  E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\RAM_128K\O #
#                    bj\pit.o                                                 #
#                                                                             #
#                                                                             #
###############################################################################

E:\´´ÐÂ»î¶¯\ÖÇÄÜ³µ\µÚÊ®½ì\±¾³µ³ÌÐò\1029µ÷ÊÔ°æ\Library\Drivers\PIT\pit.c
      1          /*******************************************************************************
      2          * ÎÄ¼þÃû³Æ£ºpit.c
      3          * Ãè    Êö: PIT(ÖÜÆÚ¶¨Ê±ÖÐ¶Ï)Çý¶¯³ÌÐò
      4          * ×÷    Õß£ºÍò±ù±ù
      5          * ÌØ±ðÃùÐ»£º¼Í³ÉÊ¦ÐÖ(²©¿Íhttp://blog.chinaaet.com/jihceng0622)
      6          * Ê±    ¼ä£º2012Äê5ÔÂ21ÈÕ
      7          *******************************************************************************/
      8          
      9          #include "pit.h"
     10          
     11          
     12          /*******************************************************************************
     13          * º¯ÊýÃû³Æ£ºPIT_setIntTime
     14          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     15                              TIMER0
     16                              TIMER1
     17                              TIMER2
     18                              TIMER3
     19                      time   ¶¨Ê±Ê±¼ä,µ¥Î» us
     20                      pie    ÖÐ¶ÏÊ¹ÄÜÑ¡Ôñ
     21                      prio   ÖÐ¶ÏÓÅÏÈ¼¶(È¡Öµ0-15,ÖµÔ½Ð¡ÓÅÏÈ¼¶Ô½¸ß)
     22          * Ãè    Êö£ºÉèÖÃ¶¨Ê±Æ÷
     23          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     24          void PIT_setTime(int8u_t timer, int32u_t time, int8u_t pie, int8u_t prio)
     25          {
   \                     PIT_setTime:
   \   00000000   0xB5F8             PUSH     {R3-R7,LR}
   \   00000002   0x461C             MOV      R4,R3
     26            SIM_SCGC6 |= SIM_SCGC6_PIT_MASK;               // ´ò¿ª PIT Ê±ÖÓ 
   \   00000004   0x....             LDR.N    R3,??DataTable4  ;; 0x4004803c
     27            PIT_TCTRL(timer) &= ~PIT_TCTRL_TEN_MASK;       // Í£Ö¹¶¨Ê±
   \   00000006   0x....             LDR.N    R6,??DataTable4_1  ;; 0x40037100
   \   00000008   0x681D             LDR      R5,[R3, #+0]
     28            PIT_MCR = 0x00;                                // Ê¹ÄÜPIT¹¦ÄÜ
   \   0000000A   0xF04F 0x0C00      MOV      R12,#+0
   \   0000000E   0xF445 0x0500      ORR      R5,R5,#0x800000
   \   00000012   0x601D             STR      R5,[R3, #+0]
   \   00000014   0x0103             LSLS     R3,R0,#+4
   \   00000016   0x199D             ADDS     R5,R3,R6
   \   00000018   0x68AF             LDR      R7,[R5, #+8]
   \   0000001A   0x087F             LSRS     R7,R7,#+1
   \   0000001C   0x007F             LSLS     R7,R7,#+1
   \   0000001E   0x60AF             STR      R7,[R5, #+8]
   \   00000020   0x....             LDR.N    R7,??DataTable4_2  ;; 0x40037000
   \   00000022   0xF8C7 0xC000      STR      R12,[R7, #+0]
     29            PIT_LDVAL(timer) = PIT_LDVAL_TSV(time*BUS_ClK);// ÉèÖÃ¶¨Ê±Ê±¼ä
   \   00000026   0xEB01 0x0741      ADD      R7,R1,R1, LSL #+1
   \   0000002A   0x0139             LSLS     R1,R7,#+4
   \   0000002C   0x5199             STR      R1,[R3, R6]
     30            if(pie == 1)
   \   0000002E   0x2A01             CMP      R2,#+1
   \   00000030   0xD10C             BNE.N    ??PIT_setTime_0
     31            {
     32              EnableInt_Kinetis(68+timer);                 // ¿ªÆô¶ÔÓ¦µÄÖÐ¶Ï
   \   00000032   0xF100 0x0644      ADD      R6,R0,#+68
   \   00000036   0x4630             MOV      R0,R6
   \   00000038   0x.... 0x....      BL       EnableInt_Kinetis
     33              SetIntPri_Kinetis(68+timer,prio);            // ÉèÖÃÖÐ¶ÏÓÅÏÈ¼¶
   \   0000003C   0x4621             MOV      R1,R4
   \   0000003E   0x4630             MOV      R0,R6
   \   00000040   0x.... 0x....      BL       SetIntPri_Kinetis
     34              PIT_TCTRL(timer) |= PIT_TCTRL_TIE_MASK;      // Ê¹ÄÜ¶¨Ê±ÖÐ¶Ï
   \   00000044   0x68A8             LDR      R0,[R5, #+8]
   \   00000046   0xF040 0x0002      ORR      R0,R0,#0x2
   \   0000004A   0xE002             B.N      ??PIT_setTime_1
     35            }
     36            else
     37            {
     38              PIT_TCTRL(timer) &= ~PIT_TCTRL_TIE_MASK;     // ½ûÖ¹¶¨Ê±ÖÐ¶Ï
   \                     ??PIT_setTime_0:
   \   0000004C   0x68A8             LDR      R0,[R5, #+8]
   \   0000004E   0xF020 0x0002      BIC      R0,R0,#0x2
   \                     ??PIT_setTime_1:
   \   00000052   0x60A8             STR      R0,[R5, #+8]
     39            }
     40            PIT_TCTRL(timer) |= PIT_TCTRL_TEN_MASK;        // ¿ªÊ¼¶¨Ê±
   \   00000054   0x68A8             LDR      R0,[R5, #+8]
   \   00000056   0xF040 0x0001      ORR      R0,R0,#0x1
   \   0000005A   0x60A8             STR      R0,[R5, #+8]
     41          }
   \   0000005C   0xBDF1             POP      {R0,R4-R7,PC}    ;; return
     42          
     43          /*******************************************************************************
     44          * º¯ÊýÃû³Æ£ºPIT_start
     45          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     46                              TIMER0
     47                              TIMER1
     48                              TIMER2
     49                              TIMER3
     50          * Ãè    Êö£º¿ªÊ¼¶¨Ê±
     51          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     52          void PIT_start(int8u_t timer)
     53          {
     54            PIT_TCTRL(timer) |= PIT_TCTRL_TEN_MASK;        // ¿ªÊ¼¶¨Ê±
   \                     PIT_start:
   \   00000000   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000002   0xEB01 0x1000      ADD      R0,R1,R0, LSL #+4
   \   00000006   0x6881             LDR      R1,[R0, #+8]
   \   00000008   0xF041 0x0101      ORR      R1,R1,#0x1
   \   0000000C   0x6081             STR      R1,[R0, #+8]
     55          }
   \   0000000E   0x4770             BX       LR               ;; return
     56          
     57          /*******************************************************************************
     58          * º¯ÊýÃû³Æ£ºPIT_stop
     59          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     60                              TIMER0
     61                              TIMER1
     62                              TIMER2
     63                              TIMER3
     64          * Ãè    Êö£ºÍ£Ö¹¶¨Ê±
     65          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     66          void PIT_stop(int8u_t timer)
     67          {
     68            PIT_TCTRL(timer) &= ~PIT_TCTRL_TEN_MASK;      // Í£Ö¹¶¨Ê±
   \                     PIT_stop:
   \   00000000   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000002   0xEB01 0x1000      ADD      R0,R1,R0, LSL #+4
   \   00000006   0x6881             LDR      R1,[R0, #+8]
   \   00000008   0x0849             LSRS     R1,R1,#+1
   \   0000000A   0x0049             LSLS     R1,R1,#+1
   \   0000000C   0x6081             STR      R1,[R0, #+8]
     69          }
   \   0000000E   0x4770             BX       LR               ;; return
     70           
     71          /*******************************************************************************
     72          * º¯ÊýÃû³Æ£ºPIT_stop
     73          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     74                              TIMER0
     75                              TIMER1
     76                              TIMER2
     77                              TIMER3
     78          * Ãè    Êö£ºÇåÁãÖÐ¶Ï±êÖ¾Î»
     79          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     80          void PIT_clearIntFlg(int8u_t timer)
     81          {
     82            PIT_TFLG(timer) = PIT_TFLG_TIF_MASK;         // ÇåÁãÖÐ¶Ï±êÖ¾Î»
   \                     PIT_clearIntFlg:
   \   00000000   0x....             LDR.N    R1,??DataTable4_1  ;; 0x40037100
   \   00000002   0xEB01 0x1000      ADD      R0,R1,R0, LSL #+4
   \   00000006   0x2101             MOVS     R1,#+1
   \   00000008   0x60C1             STR      R1,[R0, #+12]
     83          }
   \   0000000A   0x4770             BX       LR               ;; return
     84          
     85          /*******************************************************************************
     86          * º¯ÊýÃû³Æ£ºPIT_readValue
     87          * Èë¿Ú²ÎÊý£ºtimer  PIT¶¨Ê±Æ÷Æ÷Ñ¡Ôñ
     88                              TIMER0
     89                              TIMER1
     90                              TIMER2
     91                              TIMER3
     92                      result ¼ÆÊýÆ÷µ±Ç°ÊýÖµ
     93          * Ãè    Êö£º¶ÁÈ¡¼ÆÊýÆ÷µ±Ç°ÊýÖµ
     94          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     95          void PIT_readValue(int8u_t timer, int32u_t * result)
     96          {
     97            *result = PIT_CVAL(timer);
   \                     PIT_readValue:
   \   00000000   0x....             LDR.N    R2,??DataTable4_1  ;; 0x40037100
   \   00000002   0xEB02 0x1000      ADD      R0,R2,R0, LSL #+4
   \   00000006   0x6840             LDR      R0,[R0, #+4]
   \   00000008   0x6008             STR      R0,[R1, #+0]
     98          }
   \   0000000A   0x4770             BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   0x4004803C         DC32     0x4004803c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_1:
   \   00000000   0x40037100         DC32     0x40037100

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_2:
   \   00000000   0x40037000         DC32     0x40037000
     99          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        0  PIT_clearIntFlg
        0  PIT_readValue
       24  PIT_setTime
             24 -> EnableInt_Kinetis
             24 -> SetIntPri_Kinetis
        0  PIT_start
        0  PIT_stop


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable4
       4  ??DataTable4_1
       4  ??DataTable4_2
      12  PIT_clearIntFlg
      12  PIT_readValue
      94  PIT_setTime
      16  PIT_start
      16  PIT_stop

 
 162 bytes in section .text
 
 162 bytes of CODE memory

Errors: none
Warnings: none
