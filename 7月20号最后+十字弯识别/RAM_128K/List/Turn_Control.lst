###############################################################################
#                                                                             #
#                                                       18/Jan/2013  21:34:46 #
# IAR ANSI C/C++ Compiler V6.30.6.23336/W32 EVALUATION for ARM                #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\MyFunctio #
#                    n\Turn_Control.c                                         #
#    Command line =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\MyFunctio #
#                    n\Turn_Control.c -D IAR -lCN                             #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\RAM_128K\ #
#                    List\ -lB E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ #
#                    \µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0 #
#                    \RAM_128K\List\ -o E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µ #
#                    Ú°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\201301 #
#                    18\V0.0.0\RAM_128K\Obj\ --no_cse --no_unroll             #
#                    --no_inline --no_code_motion --no_tbaa --no_clustering   #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M4  #
#                    -e --fpu=None --dlib_config                              #
#                    D:\Tools\IAR6.30\arm\INC\c\DLib_Config_Normal.h -I       #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\Library\C #
#                    PU\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ #
#                    °Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\Li #
#                    brary\Drivers\ADC\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁ #
#                    Ï\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\201 #
#                    30118\V0.0.0\Library\Drivers\FTM\ -I                     #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\Library\D #
#                    rivers\GPIO\ -I E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë #
#                    ½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\ #
#                    V0.0.0\Library\Drivers\PIT\ -I                           #
#                    E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\MyFunctio #
#                    n\ -Ol                                                   #
#    List file    =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\RAM_128K\ #
#                    List\Turn_Control.lst                                    #
#    Object file  =  E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄ #
#                    Ü³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\RAM_128K\ #
#                    Obj\Turn_Control.o                                       #
#                                                                             #
#                                                                             #
###############################################################################

E:\¿ÎÍâ×ÊÁÏ\·ÉË¼¿¨¶ûÖÇÄÜ³µ\ÈÕ³£×ÊÁÏ\µÚ°Ë½ì×ÊÁÏ\µÚ°Ë½ìÖÇÄÜ³µ\Ö±Á¢³µµ÷ÊÔ\ARM\ARMÑ§Ï°Ê¹ÓÃ\20130118\V0.0.0\MyFunction\Turn_Control.c
      1          #include "AllHeaders.h"
      2          /*-----Á¥ÊôÓÚTurn_Speed_PIDº¯Êý-----*/

   \                                 In section .bss, align 4
      3          int32s_t Turn_Speed;                               //×ªÏòËÙ¶È
   \                     Turn_Speed:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
      4          int32s_t Turn_Speedold;                            //ÀúÊ·×ªÏòËÙ¶È
   \                     Turn_Speedold:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
      5          int32s_t Turn_Speednew;                            //×îÐÂ×ªÏòËÙ¶È
   \                     Turn_Speednew:
   \   00000000                      DS8 4
      6          
      7          
      8          #define Turn_Kp   3
      9          #define Turn_Kd   4
     10          
     11          
     12          

   \                                 In section .bss, align 4
     13          int Total_Weight = 0;
   \                     Total_Weight:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     14          int Total_Weight_Last=0;
   \                     Total_Weight_Last:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     15          int Servo_Temp_P = 0;
   \                     Servo_Temp_P:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     16          int Servo_Temp_D = 0;
   \                     Servo_Temp_D:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     17          int Line_Lost_Flag=0;
   \                     Line_Lost_Flag:
   \   00000000                      DS8 4
     18          
     19          
     20          /*---Á¥ÊôÓÚTurn_Speed_PID_Outº¯Êý--*/

   \                                 In section .bss, align 4
     21          int32s_t Turn_SpeedOut;                            //×ªÏòÊä³öÖµ£¬ÓÃÓÚÆ½»ºÊä³ö
   \                     Turn_SpeedOut:
   \   00000000                      DS8 4
     22          

   \                                 In section .text, align 2, keep-with-next
     23          void Turn_Speed_PID(void)
     24          {
     25            int32s_t nP,nD;
     26            
     27            if(Black_Position>-50 && Black_Position<50 && Line_Lost_Flag!=0)
   \                     Turn_Speed_PID:
   \   00000000   0x....             LDR.N    R0,??DataTable1
   \   00000002   0xF9B0 0x0000      LDRSH    R0,[R0, #+0]
   \   00000006   0xF64F 0x71CF      MOVW     R1,#+65487
   \   0000000A   0x1A40             SUBS     R0,R0,R1
   \   0000000C   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000000E   0x2863             CMP      R0,#+99
   \   00000010   0xD206             BCS.N    ??Turn_Speed_PID_0
   \   00000012   0x....             LDR.N    R0,??DataTable1_1
   \   00000014   0x6800             LDR      R0,[R0, #+0]
   \   00000016   0x2800             CMP      R0,#+0
   \   00000018   0xD002             BEQ.N    ??Turn_Speed_PID_0
     28            {
     29              Line_Lost_Flag=0;
   \   0000001A   0x....             LDR.N    R0,??DataTable1_1
   \   0000001C   0x2100             MOVS     R1,#+0
   \   0000001E   0x6001             STR      R1,[R0, #+0]
     30            }
     31            if(Black_Position>=50 && Line_Lost_Flag==0)
   \                     ??Turn_Speed_PID_0:
   \   00000020   0x....             LDR.N    R0,??DataTable1
   \   00000022   0xF9B0 0x0000      LDRSH    R0,[R0, #+0]
   \   00000026   0x2832             CMP      R0,#+50
   \   00000028   0xDB09             BLT.N    ??Turn_Speed_PID_1
   \   0000002A   0x....             LDR.N    R0,??DataTable1_1
   \   0000002C   0x6800             LDR      R0,[R0, #+0]
   \   0000002E   0x2800             CMP      R0,#+0
   \   00000030   0xD105             BNE.N    ??Turn_Speed_PID_1
     32            {
     33               Total_Weight=50;
   \   00000032   0x....             LDR.N    R0,??DataTable1_2
   \   00000034   0x2132             MOVS     R1,#+50
   \   00000036   0x6001             STR      R1,[R0, #+0]
     34               Line_Lost_Flag=1;
   \   00000038   0x....             LDR.N    R0,??DataTable1_1
   \   0000003A   0x2101             MOVS     R1,#+1
   \   0000003C   0x6001             STR      R1,[R0, #+0]
     35            }
     36            if(Black_Position<=-50 && Line_Lost_Flag==0)
   \                     ??Turn_Speed_PID_1:
   \   0000003E   0x....             LDR.N    R0,??DataTable1
   \   00000040   0xF9B0 0x0000      LDRSH    R0,[R0, #+0]
   \   00000044   0xF07F 0x0130      MVNS     R1,#+48
   \   00000048   0x4288             CMP      R0,R1
   \   0000004A   0xDA0A             BGE.N    ??Turn_Speed_PID_2
   \   0000004C   0x....             LDR.N    R0,??DataTable1_1
   \   0000004E   0x6800             LDR      R0,[R0, #+0]
   \   00000050   0x2800             CMP      R0,#+0
   \   00000052   0xD106             BNE.N    ??Turn_Speed_PID_2
     37            {
     38               Total_Weight=-50;
   \   00000054   0x....             LDR.N    R0,??DataTable1_2
   \   00000056   0xF07F 0x0131      MVNS     R1,#+49
   \   0000005A   0x6001             STR      R1,[R0, #+0]
     39               Line_Lost_Flag=2;
   \   0000005C   0x....             LDR.N    R0,??DataTable1_1
   \   0000005E   0x2102             MOVS     R1,#+2
   \   00000060   0x6001             STR      R1,[R0, #+0]
     40            }
     41            
     42            if(Line_Lost_Flag==0)
   \                     ??Turn_Speed_PID_2:
   \   00000062   0x....             LDR.N    R0,??DataTable1_1
   \   00000064   0x6800             LDR      R0,[R0, #+0]
   \   00000066   0x2800             CMP      R0,#+0
   \   00000068   0xD104             BNE.N    ??Turn_Speed_PID_3
     43            {   
     44               Total_Weight= Black_Position; 
   \   0000006A   0x....             LDR.N    R0,??DataTable1_2
   \   0000006C   0x....             LDR.N    R1,??DataTable1
   \   0000006E   0xF9B1 0x1000      LDRSH    R1,[R1, #+0]
   \   00000072   0x6001             STR      R1,[R0, #+0]
     45            }
     46            Servo_Temp_P = (int)(Total_Weight * Turn_Kp);       //¼ÆËã³ö¿ØÖÆÁ¿
   \                     ??Turn_Speed_PID_3:
   \   00000074   0x....             LDR.N    R0,??DataTable1_2
   \   00000076   0x6800             LDR      R0,[R0, #+0]
   \   00000078   0x2103             MOVS     R1,#+3
   \   0000007A   0x4348             MULS     R0,R1,R0
   \   0000007C   0x....             LDR.N    R1,??DataTable1_3
   \   0000007E   0x6008             STR      R0,[R1, #+0]
     47            Servo_Temp_D = (int)((Total_Weight-Total_Weight_Last)*(Turn_Kd));
   \   00000080   0x....             LDR.N    R0,??DataTable1_2
   \   00000082   0x6800             LDR      R0,[R0, #+0]
   \   00000084   0x....             LDR.N    R1,??DataTable1_4
   \   00000086   0x6809             LDR      R1,[R1, #+0]
   \   00000088   0x1A40             SUBS     R0,R0,R1
   \   0000008A   0x0080             LSLS     R0,R0,#+2
   \   0000008C   0x....             LDR.N    R1,??DataTable1_5
   \   0000008E   0x6008             STR      R0,[R1, #+0]
     48            Total_Weight_Last=Total_Weight;
   \   00000090   0x....             LDR.N    R0,??DataTable1_4
   \   00000092   0x....             LDR.N    R1,??DataTable1_2
   \   00000094   0x6809             LDR      R1,[R1, #+0]
   \   00000096   0x6001             STR      R1,[R0, #+0]
     49            nP=(int32s_t)(Servo_Temp_P); //¼ÆËã±ÈÀý²¿·Ö×ªÏòËÙ¶È
   \   00000098   0x....             LDR.N    R0,??DataTable1_3
   \   0000009A   0x6800             LDR      R0,[R0, #+0]
     50            nD=(int32s_t)(Servo_Temp_D); //¼ÆËãÎ¢·Ö²¿·Ö×ªÏòËÙ¶È
   \   0000009C   0x....             LDR.N    R1,??DataTable1_5
   \   0000009E   0x6809             LDR      R1,[R1, #+0]
     51          
     52            Turn_Speedold = Turn_Speednew;
   \   000000A0   0x....             LDR.N    R2,??DataTable1_6
   \   000000A2   0x....             LDR.N    R3,??DataTable1_7
   \   000000A4   0x681B             LDR      R3,[R3, #+0]
   \   000000A6   0x6013             STR      R3,[R2, #+0]
     53          
     54            if(nD> 60000) 
   \   000000A8   0xF64E 0x2261      MOVW     R2,#+60001
   \   000000AC   0x4291             CMP      R1,R2
   \   000000AE   0xDB01             BLT.N    ??Turn_Speed_PID_4
     55            {
     56              nD= 60000;                                       //×ªÏòÎ¢·ÖÏÞ·ù
   \   000000B0   0xF64E 0x2160      MOVW     R1,#+60000
     57            }
     58            if(nD<-60000) 
   \                     ??Turn_Speed_PID_4:
   \   000000B4   0x....             LDR.N    R2,??DataTable1_8  ;; 0xffff15a0
   \   000000B6   0x4291             CMP      R1,R2
   \   000000B8   0xDA00             BGE.N    ??Turn_Speed_PID_5
     59            {
     60              nD=-60000;
   \   000000BA   0x....             LDR.N    R1,??DataTable1_8  ;; 0xffff15a0
     61            }
     62          
     63            Turn_Speed = (nP+nD);
   \                     ??Turn_Speed_PID_5:
   \   000000BC   0x1808             ADDS     R0,R1,R0
   \   000000BE   0x....             LDR.N    R1,??DataTable1_9
   \   000000C0   0x6008             STR      R0,[R1, #+0]
     64          
     65            Turn_Speednew=Turn_Speed;
   \   000000C2   0x....             LDR.N    R0,??DataTable1_7
   \   000000C4   0x....             LDR.N    R1,??DataTable1_9
   \   000000C6   0x6809             LDR      R1,[R1, #+0]
   \   000000C8   0x6001             STR      R1,[R0, #+0]
     66          
     67          }
   \   000000CA   0x4770             BX       LR               ;; return
     68          /*==================================
     69          º¯ÊýÃû£ºTurn_Speed_PID_Out()
     70          ×÷ÓÃ  £º¼ÆËã×ªÏòËÙ¶ÈµÄÊä³ö£¬Ê¹×ªÏòÊä³öÆ½»¬
     71          ±¸×¢  £ºÎÞ
     72          ====================================*/

   \                                 In section .text, align 2, keep-with-next
     73          void Turn_Speed_PID_Out(void)
     74          {
     75           int16s_t nValue;
     76           nValue = (int16s_t)(Turn_Speednew-Turn_Speedold);
   \                     Turn_Speed_PID_Out:
   \   00000000   0x....             LDR.N    R0,??DataTable1_7
   \   00000002   0x6800             LDR      R0,[R0, #+0]
   \   00000004   0x....             LDR.N    R1,??DataTable1_6
   \   00000006   0x6809             LDR      R1,[R1, #+0]
   \   00000008   0x1A40             SUBS     R0,R0,R1
     77           nValue = (int16s_t)(nValue * (Turn_Count + 1) / (CAR_TURN_PERIOD - 1) + Turn_Speedold);
   \   0000000A   0xB200             SXTH     R0,R0            ;; SignExt  R0,R0,#+16,#+16
   \   0000000C   0x....             LDR.N    R1,??DataTable1_10
   \   0000000E   0xF9B1 0x1000      LDRSH    R1,[R1, #+0]
   \   00000012   0x1C49             ADDS     R1,R1,#+1
   \   00000014   0x4348             MULS     R0,R1,R0
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   0000001C   0x....             LDR.N    R1,??DataTable1_6
   \   0000001E   0x6809             LDR      R1,[R1, #+0]
   \   00000020   0x1808             ADDS     R0,R1,R0
     78           Turn_SpeedOut=nValue;
   \   00000022   0x....             LDR.N    R1,??DataTable1_11
   \   00000024   0xB200             SXTH     R0,R0            ;; SignExt  R0,R0,#+16,#+16
   \   00000026   0x6008             STR      R0,[R1, #+0]
     79          // Turn_SpeedOut=0;
     80          }
   \   00000028   0x4770             BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   0x........         DC32     Black_Position

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_1:
   \   00000000   0x........         DC32     Line_Lost_Flag

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_2:
   \   00000000   0x........         DC32     Total_Weight

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_3:
   \   00000000   0x........         DC32     Servo_Temp_P

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_4:
   \   00000000   0x........         DC32     Total_Weight_Last

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_5:
   \   00000000   0x........         DC32     Servo_Temp_D

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_6:
   \   00000000   0x........         DC32     Turn_Speedold

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_7:
   \   00000000   0x........         DC32     Turn_Speednew

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_8:
   \   00000000   0xFFFF15A0         DC32     0xffff15a0

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_9:
   \   00000000   0x........         DC32     Turn_Speed

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_10:
   \   00000000   0x........         DC32     Turn_Count

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_11:
   \   00000000   0x........         DC32     Turn_SpeedOut

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        0  Turn_Speed_PID
        0  Turn_Speed_PID_Out


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       4  ??DataTable1_10
       4  ??DataTable1_11
       4  ??DataTable1_2
       4  ??DataTable1_3
       4  ??DataTable1_4
       4  ??DataTable1_5
       4  ??DataTable1_6
       4  ??DataTable1_7
       4  ??DataTable1_8
       4  ??DataTable1_9
       4  Line_Lost_Flag
       4  Servo_Temp_D
       4  Servo_Temp_P
       4  Total_Weight
       4  Total_Weight_Last
       4  Turn_Speed
       4  Turn_SpeedOut
     204  Turn_Speed_PID
      42  Turn_Speed_PID_Out
       4  Turn_Speednew
       4  Turn_Speedold

 
  36 bytes in section .bss
 294 bytes in section .text
 
 294 bytes of CODE memory
  36 bytes of DATA memory

Errors: none
Warnings: none
