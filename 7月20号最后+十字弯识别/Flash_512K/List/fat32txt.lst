###############################################################################
#                                                                             #
#                                                       22/Jul/2015  10:59:28 #
# IAR ANSI C/C++ Compiler V6.30.6.23336/W32 EVALUATION for ARM                #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\SD_System\f #
#                    at32txt.c                                                #
#    Command line =  C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\SD_System\f #
#                    at32txt.c -D IAR -lCN C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+ #
#                    Ê®×ÖÍäÊ¶±ð\Flash_512K\List\ -lB                          #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Flash_512K\ #
#                    List\ -o C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Fl #
#                    ash_512K\Obj\ --no_cse --no_unroll --no_inline           #
#                    --no_code_motion --no_tbaa --no_clustering               #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M4  #
#                    -e --char_is_signed --fpu=None --dlib_config             #
#                    "C:\Program Files\IAR Systems\Embedded Workbench 6.0     #
#                    Evaluation\arm\INC\c\DLib_Config_Normal.h" -I            #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Library\CPU #
#                    \ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Librar #
#                    y\Drivers\ADC\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×Ö #
#                    ÍäÊ¶±ð\Library\Drivers\FTM\ -I                           #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Library\Dri #
#                    vers\GPIO\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶ #
#                    ±ð\Library\Drivers\PIT\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ #
#                    ×îºó+Ê®×ÖÍäÊ¶±ð\Library\Drivers\I2C\ -I                  #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Library\Dri #
#                    vers\UART\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶ #
#                    ±ð\Library\Drivers\FTFL\ -I                              #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\MyFunction\ #
#                     -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\SD_Syst #
#                    em\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Dela #
#                    y\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Syste #
#                    m_Init\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\ #
#                    OLED\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\ZL #
#                    G7290\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\S #
#                    imple_AD\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶± #
#                    ð\Make_Desicion\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê® #
#                    ×ÖÍäÊ¶±ð\Make_Desicion\Judge_Way\ -I                     #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Make_Desici #
#                    on\Speed_Control\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê #
#                    ®×ÖÍäÊ¶±ð\Source\ -I C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê #
#                    ®×ÖÍäÊ¶±ð\Peripheral_Oparation\ -I                       #
#                    C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Balance_con #
#                    trol\ -Ol                                                #
#    List file    =  C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Flash_512K\ #
#                    List\fat32txt.lst                                        #
#    Object file  =  C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\Flash_512K\ #
#                    Obj\fat32txt.o                                           #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\dong\Desktop\7ÔÂ20ºÅ×îºó+Ê®×ÖÍäÊ¶±ð\SD_System\fat32txt.c
      1          /******************************************************************************
      2          
      3          * fat32txt.c
      4          
      5          * fat32ÎÄ¼þÏµÍ³²Ù×÷£¨Ð´µ¥¸ö´óµÄTXTÎÄ¼þ£© 
      6          
      7          * µÚÒ»×÷Õß£º  ¼Í³É   (µÚËÄ½ìÉãÏñÍ·)
      8            ÍêÉÆÓëÕûÀí£ºËïÎÄ½¡ (µÚÁù½ìÉãÏñÍ·)
      9          * °æ±¾£ºV1.15 (ÓëV1.13¡¢v1.14°æÏà¼æÈÝ,²»Ê¹ÄÜË«»º´æÊ±ÓëV1.10Ö®ºóµÄ°æ±¾Ïà¼æÈÝ)
     10          * °æ±¾¸üÐÂÊ±¼ä£º2012Äê1ÔÂ30ÈÕ
     11           
     12          ******************************************************************************/
     13          
     14          #include "./SD_System.h"
     15          #include "AllHeaders.h"                                
     16          #ifdef EN_SD                 
     17          

   \                                 In section .rodata, align 4
     18          static byte_sd const dir_sd[32]=                             /************By Sword************/
   \                     dir_sd:
   \   00000000   0x41 0x2C          DC8 65, 44, 123, 140, 78, 227, 78, 10, 78, 77, 79, 15, 0, 49, 58, 103
   \              0x7B 0x8C    
   \              0x4E 0xE3    
   \              0x4E 0x0A    
   \              0x4E 0x4D    
   \              0x4F 0x0F    
   \              0x00 0x31    
   \              0x3A 0x67    
   \   00000010   0x2E 0x00          DC8 46, 0, 108, 0, 110, 0, 107, 0, 0, 0, 0, 0, 255, 255, 255, 255
   \              0x6C 0x00    
   \              0x6E 0x00    
   \              0x6B 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0xFF 0xFF    
   \              0xFF 0xFF    
     19          {
     20          0x41,0x2c,0x7b,0x8c,0x4e,0xe3,0x4e,0x0a,0x4e,0x4d,0x4f,0x0f,0x00,0x31,0x3a,0x67,
     21          0x2e,0x00,0x6c,0x00,0x6e,0x00,0x6b,0x00,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff 
     22          };
     23          //¾í±êÊôÐÔ,µ±¼ì²âµ½¸ùÄ¿Â¼µÄµÚÒ»¸öµ¥ÔªÎª¿ÕÊ±Ð´Èë¸ÃÄÚÈÝ

   \                                 In section .rodata, align 4
     24          static byte_sd const file_property[15]=
   \                     file_property:
   \   00000000   0x20 0x18          DC8 32, 24, 0, 0, 0, 100, 59, 100, 59, 0, 0, 0, 0, 100, 59, 0
   \              0x00 0x00    
   \              0x00 0x64    
   \              0x3B 0x64    
   \              0x3B 0x00    
   \              0x00 0x00    
   \              0x00 0x64    
   \              0x3B 0x00    
     25          {0x20,0x18,0x00,0x00,0x00,0x64,0x3b,0x64,0x3b,0x00,0x00,0x00,0x00,0x64,0x3b};
     26          //ÎÄ¼þÊôÐÔ

   \                                 In section .data, align 4
     27          static byte_sd  file_name[11]=                               /************By Sword************/
   \                     file_name:
   \   00000000   0x43 0x41          DC8 67, 65, 82, 45, 45, 48, 48, 48, 84, 88, 84, 0
   \              0x52 0x2D    
   \              0x2D 0x30    
   \              0x30 0x30    
   \              0x54 0x58    
   \              0x54 0x00    
     28          {'C','A','R','-','-','0','0','0',0x54,0x58,0x54};
     29          //ÎÄ¼þÃû³Æ(º¬À©Õ¹Ãû)
     30          //×¢,Ó¢ÎÄ×ÖÄ¸±ØÐë´óÐ´£¬·ñÔòÎÄ¼þ´ò²»¿ª£¡£¡£¡
     31          

   \                                 In section .bss, align 4
     32          static dword_sd add_sta,add_dir,add_f1,add_f2;               /************By Sword************/
   \                     add_sta:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
   \                     add_dir:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
   \                     add_f1:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
   \                     add_f2:
   \   00000000                      DS8 4
     33          //Æô¶¯ÉÈÇø¡¢¸ùÄ¿Â¼¡¢fat1¡¢fat2µÄÊ×µØÖ·£¨³õÊ¼Öµ£©

   \                                 In section .bss, align 4
     34          static dword_sd p_datasector;      //Êý¾ÝÉÈÇøÖ¸Õë            /************By Sword************/
   \                     p_datasector:
   \   00000000                      DS8 4

   \                                 In section .bss, align 2
     35          static word_sd  p_sector;  //ÉÈÇøÖ¸Õë                        /************By Sword************/
   \                     p_sector:
   \   00000000                      DS8 2

   \                                 In section .bss, align 4
     36          static dword_sd file_size=0;
   \                     file_size:
   \   00000000                      DS8 4

   \                                 In section .bss, align 1
     37          static byte_sd  sector_cluster; //Ã¿ÉÈÇø¶ÔÓ¦µÄ´ØÊý
   \                     sector_cluster:
   \   00000000                      DS8 1

   \                                 In section .bss, align 4
     38          static dword_sd sector_sta;     //Æô¶¯ÉÈÇøÉÈÇøÊý
   \                     sector_sta:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     39          static dword_sd sector_fat;     //fat±íÉÈÇøÊý
   \                     sector_fat:
   \   00000000                      DS8 4

   \                                 In section .bss, align 2
     40          static word_sd  cluster_number,ram_number;
   \                     cluster_number:
   \   00000000                      DS8 2

   \                                 In section .bss, align 2
   \                     ram_number:
   \   00000000                      DS8 2

   \                                 In section .bss, align 2
     41          static word_sd  cnt_cluster;
   \                     cnt_cluster:
   \   00000000                      DS8 2

   \                                 In section .bss, align 2
     42          static word_sd  p_segcluster;     //´Ø×éµÄÖ¸Õë
   \                     p_segcluster:
   \   00000000                      DS8 2

   \                                 In section .bss, align 1
     43          static byte_sd  num_segcluster;   //µ±Ç°´Ø×éµÄ³¤¶È
   \                     num_segcluster:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     44          static byte_sd  p_cluster;        //Ö¸Ïòµ±Ç°´Ø×éÖÐ´ØµÄÎ»ÖÃµÄÖ¸Õë
   \                     p_cluster:
   \   00000000                      DS8 1

   \                                 In section .bss, align 4
     45          static byte_sd  DBUF[512];        //¶¨Òå512×Ö½Ú»º³åÇø
   \                     DBUF:
   \   00000000                      DS8 512

   \                                 In section .bss, align 4
     46          static dword_sd  next_cluster[SD_MAX_segment]; 
   \                     next_cluster:
   \   00000000                      DS8 160
     47          //±ê¼ÇÏÂÒ»¸ö´Ø×é:µÍ24Î»±íÊ¾¸Ã´Ø×éµÄÆðÊ¼µØÖ·,¸ß8Î»±íÊ¾´ØµÄ¸öÊý   
     48          /************By Sword************/ 
     49          
     50          
     51          #ifdef EN_SDbuf   //Ë«»º³åÄ£Ê½
     52          

   \                                 In section .bss, align 4
     53          static byte_sd  DBUF2[512];   //SD¿¨µÚ¶þ»º³åÇø
   \                     DBUF2:
   \   00000000                      DS8 512

   \                                 In section .bss, align 4
     54          static dword_sd Sector_SDbuf; //µÚ¶þ»º´æÖÐÊý¾Ý¶ÔÓ¦µÄÄ¿µÄÉÈÇø
   \                     Sector_SDbuf:
   \   00000000                      DS8 4

   \                                 In section .bss, align 1
     55          static byte_sd  Stat_SDbuf;   //µÚ¶þ»º´æ×´Ì¬±êÖ¾(=0±íÊ¾Îª¿Õ)
   \                     Stat_SDbuf:
   \   00000000                      DS8 1
     56          

   \                                 In section .bss, align 4
     57          static byte_sd *pBuf_Now,*pBuf_2; //µ±Ç°»º´æÓëµÚ¶þ»º´æÖ¸Õë
   \                     pBuf_Now:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
   \                     pBuf_2:
   \   00000000                      DS8 4
     58          /*
     59          ×¢Òâ£º½«Êý¾Ý´æÈëµÚ¶þ»º³åµÄ¹ý³Ì²¢²»ÊÇ½«Êý¾Ý¸´ÖÆ¹ýÈ¥,
     60          ¶øÊÇ½»»»Á½¸ö»º³åÇøµÄÖ¸Õë,´Ó¶ø¿ÉÒÔ´ó´ó¼Ó¿ì³ÌÐòÖ´ÐÐËÙ¶È
     61          */
     62          
     63          #ifdef EN_Cnt_SDbuf
     64          word_sd Cnt_SDbufS1,Cnt_SDbufS2,Cnt_SDbufS3,Cnt_SDbufS4,Cnt_SDbufS5;
     65          /*»º´æÊ¹ÓÃ×´¿öÍ³¼Æ±äÁ¿*/
     66          /*
     67          Cnt_SDbufS1:Õý³£Çé¿öµÄÊýÁ¿(SD¿¨·ÇÃ¦,»º´æÎª¿Õ)
     68          Cnt_SDbufS2:SD¿¨·ÇÃ¦,»º´æ·Ç¿Õ,ÇÒÐ´Èë»º´æºó¿É¼ÌÐøÐ´ÈëÐÂÊý¾Ý
     69          Cnt_SDbufS3:SD¿¨·ÇÃ¦,»º´æ·Ç¿Õ,µ«Ð´Èë»º´æºóµÈ´ý³¬Ê±,²»ÄÜ¼ÌÐøÐ´ÈëÐÂÊý¾Ý
     70          Cnt_SDbufS4:SD¿¨Ã¦,µ«»º´æÎª¿Õ,¿ÉÒÔ½«ÐÂÊý¾Ý´æÈë»º´æ
     71          Cnt_SDbufS5:SD¿¨Ã¦,ÇÒ»º´æ·Ç¿Õ,Ö»ÄÜ¸ÉµÈ
     72          */
     73          #endif
     74          
     75          /***********************************************************
     76          * function:SD_WriteBlock_UserBuf
     77          * description:sd¿¨Ë«»º³å¶ÁÐ´º¯Êý
     78          ************************************************************/

   \                                 In section .text, align 2, keep-with-next
     79          static byte_sd SD_WriteBlock_UserBuf(void)
     80          {
   \                     SD_WriteBlock_UserBuf:
   \   00000000   0xB538             PUSH     {R3-R5,LR}
     81            byte_sd r1=0,retry;
   \   00000002   0x2400             MOVS     R4,#+0
     82            byte_sd *pTmp;
     83            
     84            Wait_SDRdy(SD_SHORT_Wait);
   \   00000004   0xF241 0x3088      MOVW     R0,#+5000
   \   00000008   0x.... 0x....      BL       Wait_SDRdy
     85            if(Flag_SDRdy == 0)
   \   0000000C   0x.... 0x....      LDR.W    R0,??DataTable7
   \   00000010   0x7800             LDRB     R0,[R0, #+0]
   \   00000012   0x2800             CMP      R0,#+0
   \   00000014   0xD144             BNE.N    ??SD_WriteBlock_UserBuf_0
     86            { //SD¿¨Ã¦
     87              if(Stat_SDbuf == 0)
   \   00000016   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \   0000001A   0x7800             LDRB     R0,[R0, #+0]
   \   0000001C   0x2800             CMP      R0,#+0
   \   0000001E   0xD116             BNE.N    ??SD_WriteBlock_UserBuf_1
     88              { //»º´æÎª¿Õ
     89              //½«Êý¾ÝÏÈ´æÈë»º´æ(ËùÎ½´æÈë¾ÍÊÇ½»»»Á½¸ö»º´æµÄÖ¸Õë)
     90                pTmp=pBuf_Now;
   \   00000020   0x.... 0x....      LDR.W    R0,??DataTable9
   \   00000024   0x6800             LDR      R0,[R0, #+0]
     91                pBuf_Now=pBuf_2;
   \   00000026   0x.... 0x....      LDR.W    R1,??DataTable9
   \   0000002A   0x.... 0x....      LDR.W    R2,??DataTable7_2
   \   0000002E   0x6812             LDR      R2,[R2, #+0]
   \   00000030   0x600A             STR      R2,[R1, #+0]
     92                pBuf_2=pTmp;
   \   00000032   0x.... 0x....      LDR.W    R1,??DataTable7_2
   \   00000036   0x6008             STR      R0,[R1, #+0]
     93                Sector_SDbuf=p_datasector;
   \   00000038   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   0000003C   0x.... 0x....      LDR.W    R1,??DataTable10
   \   00000040   0x6809             LDR      R1,[R1, #+0]
   \   00000042   0x6001             STR      R1,[R0, #+0]
     94                Stat_SDbuf=1; //ÖÃÎ»»º´æ±êÖ¾
   \   00000044   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \   00000048   0x2101             MOVS     R1,#+1
   \   0000004A   0x7001             STRB     R1,[R0, #+0]
   \   0000004C   0xE084             B.N      ??SD_WriteBlock_UserBuf_2
     95          #ifdef EN_Cnt_SDbuf      
     96                Cnt_SDbufS4++;
     97          #endif
     98              }
     99              else
    100              { //»º´æ·Ç¿Õ(×îÎÞÓïµÄÇé¿ö,Ä¿Ç°µÄËã·¨Ã»ÓÐ°ì·¨ÓÅ»¯)
    101              //»º´æ·Ç¿Õ,Ö»ÄÜ¸ÉµÈ  
    102                Wait_SDRdy(SD_LONG_Wait);
   \                     ??SD_WriteBlock_UserBuf_1:
   \   0000004E   0x.... 0x....      LDR.W    R0,??DataTable7_4  ;; 0x1e8480
   \   00000052   0x.... 0x....      BL       Wait_SDRdy
    103                retry=0;
   \   00000056   0x2500             MOVS     R5,#+0
    104                do //½«»º´æÖÐ´æµÄÊý¾ÝÐ´ÈëSD¿¨
    105                {  
    106                  r1=sd_writesingleblock(pBuf_2,Sector_SDbuf);
   \                     ??SD_WriteBlock_UserBuf_3:
   \   00000058   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   0000005C   0x6801             LDR      R1,[R0, #+0]
   \   0000005E   0x.... 0x....      LDR.W    R0,??DataTable7_2
   \   00000062   0x6800             LDR      R0,[R0, #+0]
   \   00000064   0x.... 0x....      BL       sd_writesingleblock
   \   00000068   0x0004             MOVS     R4,R0
    107                } while(r1!=0 && (++retry)<3);
   \   0000006A   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000006C   0x2C00             CMP      R4,#+0
   \   0000006E   0xD004             BEQ.N    ??SD_WriteBlock_UserBuf_4
   \   00000070   0x1C6D             ADDS     R5,R5,#+1
   \   00000072   0x0028             MOVS     R0,R5
   \   00000074   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000076   0x2803             CMP      R0,#+3
   \   00000078   0xD3EE             BCC.N    ??SD_WriteBlock_UserBuf_3
    108              //½«Êý¾ÝÔÙ´æÈë»º´æ
    109                pTmp=pBuf_Now;
   \                     ??SD_WriteBlock_UserBuf_4:
   \   0000007A   0x.... 0x....      LDR.W    R0,??DataTable9
   \   0000007E   0x6800             LDR      R0,[R0, #+0]
    110                pBuf_Now=pBuf_2;
   \   00000080   0x.... 0x....      LDR.W    R1,??DataTable9
   \   00000084   0x.... 0x....      LDR.W    R2,??DataTable7_2
   \   00000088   0x6812             LDR      R2,[R2, #+0]
   \   0000008A   0x600A             STR      R2,[R1, #+0]
    111                pBuf_2=pTmp;
   \   0000008C   0x.... 0x....      LDR.W    R1,??DataTable7_2
   \   00000090   0x6008             STR      R0,[R1, #+0]
    112                Sector_SDbuf=p_datasector;
   \   00000092   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   00000096   0x.... 0x....      LDR.W    R1,??DataTable10
   \   0000009A   0x6809             LDR      R1,[R1, #+0]
   \   0000009C   0x6001             STR      R1,[R0, #+0]
   \   0000009E   0xE05B             B.N      ??SD_WriteBlock_UserBuf_2
    113          #ifdef EN_Cnt_SDbuf   
    114                Cnt_SDbufS5++;
    115          #endif      
    116              }
    117            }
    118            else
    119            { //SD¿¨·ÇÃ¦
    120              if(Stat_SDbuf == 0)
   \                     ??SD_WriteBlock_UserBuf_0:
   \   000000A0   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \   000000A4   0x7800             LDRB     R0,[R0, #+0]
   \   000000A6   0x2800             CMP      R0,#+0
   \   000000A8   0xD112             BNE.N    ??SD_WriteBlock_UserBuf_5
    121              { //»º´æÎª¿Õ(×îÀíÏëµÄ×´¿ö)
    122                retry=0;
   \   000000AA   0x2500             MOVS     R5,#+0
    123                do //½«Êý¾ÝÐ´ÈëSD¿¨
    124                {  
    125                  r1=sd_writesingleblock(pBuf_Now,p_datasector);
   \                     ??SD_WriteBlock_UserBuf_6:
   \   000000AC   0x.... 0x....      LDR.W    R0,??DataTable10
   \   000000B0   0x6801             LDR      R1,[R0, #+0]
   \   000000B2   0x.... 0x....      LDR.W    R0,??DataTable9
   \   000000B6   0x6800             LDR      R0,[R0, #+0]
   \   000000B8   0x.... 0x....      BL       sd_writesingleblock
   \   000000BC   0x0004             MOVS     R4,R0
    126                } while(r1!=0 && (++retry)<3);
   \   000000BE   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   000000C0   0x2C00             CMP      R4,#+0
   \   000000C2   0xD049             BEQ.N    ??SD_WriteBlock_UserBuf_2
   \   000000C4   0x1C6D             ADDS     R5,R5,#+1
   \   000000C6   0x0028             MOVS     R0,R5
   \   000000C8   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000CA   0x2803             CMP      R0,#+3
   \   000000CC   0xD3EE             BCC.N    ??SD_WriteBlock_UserBuf_6
   \   000000CE   0xE043             B.N      ??SD_WriteBlock_UserBuf_2
    127          #ifdef EN_Cnt_SDbuf      
    128                Cnt_SDbufS1++;
    129          #endif
    130              }
    131              else
    132              { //»º´æ·Ç¿Õ
    133                retry=0;
   \                     ??SD_WriteBlock_UserBuf_5:
   \   000000D0   0x2500             MOVS     R5,#+0
    134                do //½«»º´æÖÐ´æµÄÊý¾ÝÐ´ÈëSD¿¨
    135                {  
    136                  r1=sd_writesingleblock(pBuf_2,Sector_SDbuf);
   \                     ??SD_WriteBlock_UserBuf_7:
   \   000000D2   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   000000D6   0x6801             LDR      R1,[R0, #+0]
   \   000000D8   0x.... 0x....      LDR.W    R0,??DataTable7_2
   \   000000DC   0x6800             LDR      R0,[R0, #+0]
   \   000000DE   0x.... 0x....      BL       sd_writesingleblock
   \   000000E2   0x0004             MOVS     R4,R0
    137                } while(r1!=0 && (++retry)<3);
   \   000000E4   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   000000E6   0x2C00             CMP      R4,#+0
   \   000000E8   0xD004             BEQ.N    ??SD_WriteBlock_UserBuf_8
   \   000000EA   0x1C6D             ADDS     R5,R5,#+1
   \   000000EC   0x0028             MOVS     R0,R5
   \   000000EE   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000F0   0x2803             CMP      R0,#+3
   \   000000F2   0xD3EE             BCC.N    ??SD_WriteBlock_UserBuf_7
    138               //Ð´Íê»º´æÖÐÊý¾Ý½øÐÐ¼«¶ÌÊ±¼äµÄµÈ´ý,¸ù¾ÝµÈ´ýºóµÄ½á¹ûÅÐ¶¨ÊÇ·ñÐ´ÈëÐÂÊý¾Ý
    139                Wait_SDRdy(SD_VST_Wait);
   \                     ??SD_WriteBlock_UserBuf_8:
   \   000000F4   0xF44F 0x607A      MOV      R0,#+4000
   \   000000F8   0x.... 0x....      BL       Wait_SDRdy
    140                if(Flag_SDRdy == 0)
   \   000000FC   0x.... 0x....      LDR.W    R0,??DataTable7
   \   00000100   0x7800             LDRB     R0,[R0, #+0]
   \   00000102   0x2800             CMP      R0,#+0
   \   00000104   0xD112             BNE.N    ??SD_WriteBlock_UserBuf_9
    141                { //SD¿¨Ã¦
    142                //½«Êý¾ÝÔÙ´æÈë»º´æ
    143                  pTmp=pBuf_Now;
   \   00000106   0x.... 0x....      LDR.W    R0,??DataTable9
   \   0000010A   0x6800             LDR      R0,[R0, #+0]
    144                  pBuf_Now=pBuf_2;
   \   0000010C   0x.... 0x....      LDR.W    R1,??DataTable9
   \   00000110   0x.... 0x....      LDR.W    R2,??DataTable7_2
   \   00000114   0x6812             LDR      R2,[R2, #+0]
   \   00000116   0x600A             STR      R2,[R1, #+0]
    145                  pBuf_2=pTmp;
   \   00000118   0x.... 0x....      LDR.W    R1,??DataTable7_2
   \   0000011C   0x6008             STR      R0,[R1, #+0]
    146                  Sector_SDbuf=p_datasector;
   \   0000011E   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   00000122   0x.... 0x....      LDR.W    R1,??DataTable10
   \   00000126   0x6809             LDR      R1,[R1, #+0]
   \   00000128   0x6001             STR      R1,[R0, #+0]
   \   0000012A   0xE015             B.N      ??SD_WriteBlock_UserBuf_2
    147          #ifdef EN_Cnt_SDbuf        
    148                  Cnt_SDbufS3++;
    149          #endif
    150                }
    151                else
    152                { //SD¿¨·ÇÃ¦
    153                //»º´æÖÕÓÚ½âÍÑÁË,½øÈëÕý³£Çé¿ö
    154                  Stat_SDbuf=0; //Çå³ý»º´æ±êÖ¾
   \                     ??SD_WriteBlock_UserBuf_9:
   \   0000012C   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \   00000130   0x2100             MOVS     R1,#+0
   \   00000132   0x7001             STRB     R1,[R0, #+0]
    155                  retry=0;
   \   00000134   0x2500             MOVS     R5,#+0
    156                  do //½«Êý¾ÝÐ´ÈëSD¿¨
    157                  {  
    158                    r1=sd_writesingleblock(pBuf_Now,p_datasector);
   \                     ??SD_WriteBlock_UserBuf_10:
   \   00000136   0x.... 0x....      LDR.W    R0,??DataTable10
   \   0000013A   0x6801             LDR      R1,[R0, #+0]
   \   0000013C   0x.... 0x....      LDR.W    R0,??DataTable9
   \   00000140   0x6800             LDR      R0,[R0, #+0]
   \   00000142   0x.... 0x....      BL       sd_writesingleblock
   \   00000146   0x0004             MOVS     R4,R0
    159                  } while(r1!=0 && (++retry)<3);
   \   00000148   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000014A   0x2C00             CMP      R4,#+0
   \   0000014C   0xD004             BEQ.N    ??SD_WriteBlock_UserBuf_2
   \   0000014E   0x1C6D             ADDS     R5,R5,#+1
   \   00000150   0x0028             MOVS     R0,R5
   \   00000152   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000154   0x2803             CMP      R0,#+3
   \   00000156   0xD3EE             BCC.N    ??SD_WriteBlock_UserBuf_10
    160          #ifdef EN_Cnt_SDbuf        
    161                  Cnt_SDbufS2++;
    162          #endif
    163                }
    164              }
    165            }
    166            
    167            return r1;
   \                     ??SD_WriteBlock_UserBuf_2:
   \   00000158   0x0020             MOVS     R0,R4
   \   0000015A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000015C   0xBD32             POP      {R1,R4,R5,PC}    ;; return
    168          }
    169          /***********************************************************
    170          * function:SD_ClrBuf
    171          * description:Çå¿Õ»º´æÖÐÊý¾Ý(½«»º´æÖÐÊý¾ÝÐ´ÈëSD¿¨)
    172          ************************************************************/

   \                                 In section .text, align 2, keep-with-next
    173          static void SD_ClrBuf(void)
    174          {
   \                     SD_ClrBuf:
   \   00000000   0xB510             PUSH     {R4,LR}
    175            byte_sd r1=0,retry=0;
   \   00000002   0x2000             MOVS     R0,#+0
   \   00000004   0x2400             MOVS     R4,#+0
    176            
    177            if(Stat_SDbuf != 0)
   \   00000006   0x.... 0x....      LDR.W    R1,??DataTable7_1
   \   0000000A   0x7809             LDRB     R1,[R1, #+0]
   \   0000000C   0x2900             CMP      R1,#+0
   \   0000000E   0xD017             BEQ.N    ??SD_ClrBuf_0
    178            {
    179              Wait_SDRdy(SD_LONG_Wait);
   \   00000010   0x.... 0x....      LDR.W    R0,??DataTable7_4  ;; 0x1e8480
   \   00000014   0x.... 0x....      BL       Wait_SDRdy
    180              do //½«»º´æÖÐ´æµÄÊý¾ÝÐ´ÈëSD¿¨
    181              {  
    182                r1=sd_writesingleblock(pBuf_2,Sector_SDbuf);
   \                     ??SD_ClrBuf_1:
   \   00000018   0x.... 0x....      LDR.W    R0,??DataTable7_3
   \   0000001C   0x6801             LDR      R1,[R0, #+0]
   \   0000001E   0x.... 0x....      LDR.W    R0,??DataTable7_2
   \   00000022   0x6800             LDR      R0,[R0, #+0]
   \   00000024   0x.... 0x....      BL       sd_writesingleblock
    183              } while(r1!=0 && (++retry)<5);
   \   00000028   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000002A   0x2800             CMP      R0,#+0
   \   0000002C   0xD004             BEQ.N    ??SD_ClrBuf_2
   \   0000002E   0x1C64             ADDS     R4,R4,#+1
   \   00000030   0x0020             MOVS     R0,R4
   \   00000032   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000034   0x2805             CMP      R0,#+5
   \   00000036   0xD3EF             BCC.N    ??SD_ClrBuf_1
    184              Stat_SDbuf=0; //Çå³ý»º´æ±êÖ¾
   \                     ??SD_ClrBuf_2:
   \   00000038   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \   0000003C   0x2100             MOVS     R1,#+0
   \   0000003E   0x7001             STRB     R1,[R0, #+0]
    185            }
    186          }
   \                     ??SD_ClrBuf_0:
   \   00000040   0xBD10             POP      {R4,PC}          ;; return
    187          
    188          #endif
    189          /*********************************************************/
    190          //function:write_dir
    191          //description:Ð´¸ùÄ¿Â¼º¯Êý
    192          //ÐÞ¸Ä£º Sword
    193          /***********************************************************/

   \                                 In section .text, align 4, keep-with-next
    194          void write_dir(void)
    195          {
   \                     write_dir:
   \   00000000   0xE92D 0x41F0      PUSH     {R4-R8,LR}
    196            word_sd i=0,j,k,flag,retry=0;
   \   00000004   0x2400             MOVS     R4,#+0
   \   00000006   0x2500             MOVS     R5,#+0
    197            word_sd h_add,l_add,sum;
    198            word_sd addr=0,addh=0,max=0;
   \   00000008   0x2700             MOVS     R7,#+0
   \   0000000A   0x2600             MOVS     R6,#+0
   \   0000000C   0xF05F 0x0800      MOVS     R8,#+0
    199            byte_sd r1;
    200            
    201            do     //¿´¸ùÄ¿Â¼µÄµÚÒ»¸öµ¥Ôª(¾í±ê)ÊÇ·ñÎª¿Õ
    202             {
    203               r1=sd_readsingleblock(DBUF,add_dir);
   \                     ??write_dir_0:
   \   00000010   0x.... 0x....      LDR.W    R0,??DataTable9_1
   \   00000014   0x6801             LDR      R1,[R0, #+0]
   \   00000016   0x.... 0x....      LDR.W    R0,??DataTable12
   \   0000001A   0x.... 0x....      BL       sd_readsingleblock
    204               C_WDOG();
   \   0000001E   0xB672             CPSID i          
   \   00000020   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000024   0xF24A 0x6202      MOVW     R2,#+42498
   \   00000028   0x800A             STRH     R2,[R1, #+0]
   \   0000002A   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   0000002E   0xF24B 0x4280      MOVW     R2,#+46208
   \   00000032   0x800A             STRH     R2,[R1, #+0]
   \   00000034   0x.... 0x....      LDR.W    R1,??DataTable9_3
   \   00000038   0x7809             LDRB     R1,[R1, #+0]
   \   0000003A   0x2900             CMP      R1,#+0
   \   0000003C   0xD000             BEQ.N    ??write_dir_1
   \   0000003E   0xB662             CPSIE i          
    205               retry++;
   \                     ??write_dir_1:
   \   00000040   0x1C6D             ADDS     R5,R5,#+1
    206             } while(r1!=0x00&&retry<100);
   \   00000042   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000044   0x2800             CMP      R0,#+0
   \   00000046   0xD002             BEQ.N    ??write_dir_2
   \   00000048   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000004A   0x2D64             CMP      R5,#+100
   \   0000004C   0xD3E0             BCC.N    ??write_dir_0
    207            retry=0;
   \                     ??write_dir_2:
   \   0000004E   0x2500             MOVS     R5,#+0
    208            
    209            if(DBUF[0]==0x00)   //Èç¹û¸ùÄ¿Â¼µÚÒ»¸öµ¥ÔªÎª¿ÕÔòÐ´Èë¾í±ê
   \   00000050   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000054   0x7800             LDRB     R0,[R0, #+0]
   \   00000056   0x2800             CMP      R0,#+0
   \   00000058   0xD12E             BNE.N    ??write_dir_3
    210             {
    211               for(i=0;i<32;i++) DBUF[i]=dir_sd[i];
   \   0000005A   0x2400             MOVS     R4,#+0
   \   0000005C   0xE008             B.N      ??write_dir_4
   \                     ??write_dir_5:
   \   0000005E   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000060   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000064   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000066   0x.... 0x....      LDR.W    R1,??DataTable9_4
   \   0000006A   0x5C61             LDRB     R1,[R4, R1]
   \   0000006C   0x5421             STRB     R1,[R4, R0]
   \   0000006E   0x1C64             ADDS     R4,R4,#+1
   \                     ??write_dir_4:
   \   00000070   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000072   0x2C20             CMP      R4,#+32
   \   00000074   0xD3F3             BCC.N    ??write_dir_5
    212               while(sd_writesingleblock(DBUF,add_dir)&&retry<1000) //Ð´¾í±ê
   \                     ??write_dir_6:
   \   00000076   0x.... 0x....      LDR.W    R0,??DataTable9_1
   \   0000007A   0x6801             LDR      R1,[R0, #+0]
   \   0000007C   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000080   0x.... 0x....      BL       sd_writesingleblock
   \   00000084   0x2800             CMP      R0,#+0
   \   00000086   0xD017             BEQ.N    ??write_dir_3
   \   00000088   0xF44F 0x707A      MOV      R0,#+1000
   \   0000008C   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000008E   0x4285             CMP      R5,R0
   \   00000090   0xD212             BCS.N    ??write_dir_3
    213                {                            
    214                  C_WDOG(); //Çå¿ªÃÅ¹· 
   \   00000092   0xB672             CPSID i          
   \   00000094   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000098   0xF24A 0x6102      MOVW     R1,#+42498
   \   0000009C   0x8001             STRH     R1,[R0, #+0]
   \   0000009E   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   000000A2   0xF24B 0x4180      MOVW     R1,#+46208
   \   000000A6   0x8001             STRH     R1,[R0, #+0]
   \   000000A8   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   000000AC   0x7800             LDRB     R0,[R0, #+0]
   \   000000AE   0x2800             CMP      R0,#+0
   \   000000B0   0xD000             BEQ.N    ??write_dir_7
   \   000000B2   0xB662             CPSIE i          
    215                  retry++;
   \                     ??write_dir_7:
   \   000000B4   0x1C6D             ADDS     R5,R5,#+1
   \   000000B6   0xE7DE             B.N      ??write_dir_6
    216                } 
    217             }
    218            
    219            for(i=0;i<sector_cluster;i++)
   \                     ??write_dir_3:
   \   000000B8   0x2400             MOVS     R4,#+0
   \   000000BA   0xE000             B.N      ??write_dir_8
   \                     ??write_dir_9:
   \   000000BC   0x1C64             ADDS     R4,R4,#+1
   \                     ??write_dir_8:
   \   000000BE   0x.... 0x....      LDR.W    R0,??DataTable9_5
   \   000000C2   0x7800             LDRB     R0,[R0, #+0]
   \   000000C4   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000000C6   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000000C8   0x4284             CMP      R4,R0
   \   000000CA   0xF080 0x8091      BCS.W    ??write_dir_10
    220             { 
    221               do     //ÏÈ¶Á¸ùÄ¿Â¼ÔÙ¸ÄÐ´,´Ó¶ø±£Ö¤²»»á¸ü¸ÄÔ­À´µÄÎÄ¼þ
    222                {
    223                  r1=sd_readsingleblock(DBUF,add_dir+i);
   \                     ??write_dir_11:
   \   000000CE   0x.... 0x....      LDR.W    R0,??DataTable9_1
   \   000000D2   0x6800             LDR      R0,[R0, #+0]
   \   000000D4   0xFA10 0xF184      UXTAH    R1,R0,R4
   \   000000D8   0x.... 0x....      LDR.W    R0,??DataTable12
   \   000000DC   0x.... 0x....      BL       sd_readsingleblock
    224                  C_WDOG();
   \   000000E0   0xB672             CPSID i          
   \   000000E2   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   000000E6   0xF24A 0x6202      MOVW     R2,#+42498
   \   000000EA   0x800A             STRH     R2,[R1, #+0]
   \   000000EC   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   000000F0   0xF24B 0x4280      MOVW     R2,#+46208
   \   000000F4   0x800A             STRH     R2,[R1, #+0]
   \   000000F6   0x.... 0x....      LDR.W    R1,??DataTable9_3
   \   000000FA   0x7809             LDRB     R1,[R1, #+0]
   \   000000FC   0x2900             CMP      R1,#+0
   \   000000FE   0xD000             BEQ.N    ??write_dir_12
   \   00000100   0xB662             CPSIE i          
    225                  retry++;
   \                     ??write_dir_12:
   \   00000102   0x1C6D             ADDS     R5,R5,#+1
    226                } while(r1!=0x00&&retry<100);
   \   00000104   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000106   0x2800             CMP      R0,#+0
   \   00000108   0xD002             BEQ.N    ??write_dir_13
   \   0000010A   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000010C   0x2D64             CMP      R5,#+100
   \   0000010E   0xD3DE             BCC.N    ??write_dir_11
    227               retry=0;
   \                     ??write_dir_13:
   \   00000110   0x2500             MOVS     R5,#+0
    228              
    229               for(k=0;k<512;k+=32)
   \   00000112   0x2000             MOVS     R0,#+0
   \   00000114   0xE01F             B.N      ??write_dir_14
    230                {
    231                 
    232                  if(addr==0&&addh==0&&DBUF[k]==0x00||DBUF[k]==0xE5) 
    233                   { addh=i;addr=k; }  //Ñ°ÕÒÒ»¸ö¿Õ°×µÄ32×Ö½ÚÇø¼ä
    234                 
    235                  for(j=0,flag=1;j<5;j++)  //¾ö²ßÎÄ¼þÐòºÅ
    236                    if(DBUF[k+j]!=file_name[j]) flag=0;
    237                  if(flag)
    238                   {
    239                     if(DBUF[k+5]>'9'||DBUF[k+5]<'0') continue;
    240                     if(DBUF[k+6]>'9'||DBUF[k+6]<'0') continue;
    241                     if(DBUF[k+7]>'9'||DBUF[k+7]<'0') continue;
    242                     sum=(DBUF[k+7]-'0')+(DBUF[k+6]-'0')*10+(DBUF[k+5]-'0')*100;
   \                     ??write_dir_15:
   \   00000116   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000118   0x.... 0x....      LDR.W    R1,??DataTable12
   \   0000011C   0x1841             ADDS     R1,R0,R1
   \   0000011E   0x79C9             LDRB     R1,[R1, #+7]
   \   00000120   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000122   0x.... 0x....      LDR.W    R2,??DataTable12
   \   00000126   0x1882             ADDS     R2,R0,R2
   \   00000128   0x7992             LDRB     R2,[R2, #+6]
   \   0000012A   0x230A             MOVS     R3,#+10
   \   0000012C   0x435A             MULS     R2,R3,R2
   \   0000012E   0xFA52 0xF181      UXTAB    R1,R2,R1
   \   00000132   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000134   0x.... 0x....      LDR.W    R2,??DataTable12
   \   00000138   0x1882             ADDS     R2,R0,R2
   \   0000013A   0x7952             LDRB     R2,[R2, #+5]
   \   0000013C   0x2364             MOVS     R3,#+100
   \   0000013E   0xFB03 0x1102      MLA      R1,R3,R2,R1
   \   00000142   0xF241 0x42D0      MOVW     R2,#+5328
   \   00000146   0x1A89             SUBS     R1,R1,R2
    243                     if(sum>max) max=sum;
   \   00000148   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   0000014C   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   0000014E   0x4588             CMP      R8,R1
   \   00000150   0xD200             BCS.N    ??write_dir_16
   \   00000152   0x4688             MOV      R8,R1
   \                     ??write_dir_16:
   \   00000154   0x3020             ADDS     R0,R0,#+32
   \                     ??write_dir_14:
   \   00000156   0xF44F 0x7100      MOV      R1,#+512
   \   0000015A   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000015C   0x4288             CMP      R0,R1
   \   0000015E   0xD2AD             BCS.N    ??write_dir_9
   \   00000160   0xEA56 0x0107      ORRS     R1,R6,R7
   \   00000164   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   00000166   0x2900             CMP      R1,#+0
   \   00000168   0xD105             BNE.N    ??write_dir_17
   \   0000016A   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000016C   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000170   0x5C41             LDRB     R1,[R0, R1]
   \   00000172   0x2900             CMP      R1,#+0
   \   00000174   0xD005             BEQ.N    ??write_dir_18
   \                     ??write_dir_17:
   \   00000176   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000178   0x.... 0x....      LDR.W    R1,??DataTable12
   \   0000017C   0x5C41             LDRB     R1,[R0, R1]
   \   0000017E   0x29E5             CMP      R1,#+229
   \   00000180   0xD101             BNE.N    ??write_dir_19
   \                     ??write_dir_18:
   \   00000182   0x0026             MOVS     R6,R4
   \   00000184   0x0007             MOVS     R7,R0
   \                     ??write_dir_19:
   \   00000186   0x2100             MOVS     R1,#+0
   \   00000188   0x2201             MOVS     R2,#+1
   \   0000018A   0xE00F             B.N      ??write_dir_20
   \                     ??write_dir_21:
   \   0000018C   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   0000018E   0xFA11 0xF380      UXTAH    R3,R1,R0
   \   00000192   0x.... 0x....      LDR.W    R12,??DataTable12
   \   00000196   0xF813 0x300C      LDRB     R3,[R3, R12]
   \   0000019A   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   0000019C   0x.... 0x....      LDR.W    R12,??DataTable11
   \   000001A0   0xF811 0xC00C      LDRB     R12,[R1, R12]
   \   000001A4   0x4563             CMP      R3,R12
   \   000001A6   0xD000             BEQ.N    ??write_dir_22
   \   000001A8   0x2200             MOVS     R2,#+0
   \                     ??write_dir_22:
   \   000001AA   0x1C49             ADDS     R1,R1,#+1
   \                     ??write_dir_20:
   \   000001AC   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   000001AE   0x2905             CMP      R1,#+5
   \   000001B0   0xD3EC             BCC.N    ??write_dir_21
   \   000001B2   0xB292             UXTH     R2,R2            ;; ZeroExt  R2,R2,#+16,#+16
   \   000001B4   0x2A00             CMP      R2,#+0
   \   000001B6   0xD0CD             BEQ.N    ??write_dir_16
   \   000001B8   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001BA   0x.... 0x....      LDR.W    R1,??DataTable12
   \   000001BE   0x1841             ADDS     R1,R0,R1
   \   000001C0   0x7949             LDRB     R1,[R1, #+5]
   \   000001C2   0x3930             SUBS     R1,R1,#+48
   \   000001C4   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   000001C6   0x290A             CMP      R1,#+10
   \   000001C8   0xD2C4             BCS.N    ??write_dir_16
   \                     ??write_dir_23:
   \   000001CA   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001CC   0x.... 0x....      LDR.W    R1,??DataTable12
   \   000001D0   0x1841             ADDS     R1,R0,R1
   \   000001D2   0x7989             LDRB     R1,[R1, #+6]
   \   000001D4   0x3930             SUBS     R1,R1,#+48
   \   000001D6   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   000001D8   0x290A             CMP      R1,#+10
   \   000001DA   0xD2BB             BCS.N    ??write_dir_16
   \                     ??write_dir_24:
   \   000001DC   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001DE   0x.... 0x....      LDR.W    R1,??DataTable12
   \   000001E2   0x1841             ADDS     R1,R0,R1
   \   000001E4   0x79C9             LDRB     R1,[R1, #+7]
   \   000001E6   0x3930             SUBS     R1,R1,#+48
   \   000001E8   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   000001EA   0x290A             CMP      R1,#+10
   \   000001EC   0xD393             BCC.N    ??write_dir_15
   \   000001EE   0xE7B1             B.N      ??write_dir_16
    244                   }
    245                }
    246             }
    247            
    248            if(addh==0&&addr==0)
   \                     ??write_dir_10:
   \   000001F0   0xEA57 0x0006      ORRS     R0,R7,R6
   \   000001F4   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001F6   0x2800             CMP      R0,#+0
   \   000001F8   0xD102             BNE.N    ??write_dir_25
    249             {     //Ã»ÓÐÔÚ¸ùÄ¿Â¼ÕÒµ½¿ÕÏÐÎ»ÖÃ
    250               CloseSD();
   \   000001FA   0x.... 0x....      BL       CloseSD
    251               return;
   \   000001FE   0xE0EC             B.N      ??write_dir_26
    252             }
    253            
    254            do     //ÏÈ¶Á¸ùÄ¿Â¼ÔÙ¸ÄÐ´,´Ó¶ø±£Ö¤²»»á¸ü¸ÄÔ­À´µÄÎÄ¼þ
    255             {
    256               r1=sd_readsingleblock(DBUF,add_dir+addh);
   \                     ??write_dir_25:
   \   00000200   0x.... 0x....      LDR.W    R0,??DataTable9_1
   \   00000204   0x6800             LDR      R0,[R0, #+0]
   \   00000206   0xFA10 0xF186      UXTAH    R1,R0,R6
   \   0000020A   0x.... 0x....      LDR.W    R0,??DataTable12
   \   0000020E   0x.... 0x....      BL       sd_readsingleblock
    257               C_WDOG();
   \   00000212   0xB672             CPSID i          
   \   00000214   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000218   0xF24A 0x6202      MOVW     R2,#+42498
   \   0000021C   0x800A             STRH     R2,[R1, #+0]
   \   0000021E   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000222   0xF24B 0x4280      MOVW     R2,#+46208
   \   00000226   0x800A             STRH     R2,[R1, #+0]
   \   00000228   0x.... 0x....      LDR.W    R1,??DataTable9_3
   \   0000022C   0x7809             LDRB     R1,[R1, #+0]
   \   0000022E   0x2900             CMP      R1,#+0
   \   00000230   0xD000             BEQ.N    ??write_dir_27
   \   00000232   0xB662             CPSIE i          
    258               retry++;
   \                     ??write_dir_27:
   \   00000234   0x1C6D             ADDS     R5,R5,#+1
    259             } while(r1!=0x00&&retry<100);
   \   00000236   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000238   0x2800             CMP      R0,#+0
   \   0000023A   0xD002             BEQ.N    ??write_dir_28
   \   0000023C   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000023E   0x2D64             CMP      R5,#+100
   \   00000240   0xD3DE             BCC.N    ??write_dir_25
    260            retry=0; 
   \                     ??write_dir_28:
   \   00000242   0x2500             MOVS     R5,#+0
    261             
    262            file_name[7]=(max+1)%10+'0';   //Éú³ÉÎÄ¼þÃû
   \   00000244   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   00000248   0xF118 0x0001      ADDS     R0,R8,#+1
   \   0000024C   0x210A             MOVS     R1,#+10
   \   0000024E   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000252   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000256   0x3030             ADDS     R0,R0,#+48
   \   00000258   0x.... 0x....      LDR.W    R1,??DataTable11
   \   0000025C   0x71C8             STRB     R0,[R1, #+7]
    263            file_name[6]=(max+1)/10%10+'0'; 
   \   0000025E   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   00000262   0xF118 0x0001      ADDS     R0,R8,#+1
   \   00000266   0x210A             MOVS     R1,#+10
   \   00000268   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   0000026C   0x210A             MOVS     R1,#+10
   \   0000026E   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000272   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000276   0x3030             ADDS     R0,R0,#+48
   \   00000278   0x.... 0x....      LDR.W    R1,??DataTable11
   \   0000027C   0x7188             STRB     R0,[R1, #+6]
    264            file_name[5]=(max+1)/100+'0';
   \   0000027E   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   00000282   0xF118 0x0001      ADDS     R0,R8,#+1
   \   00000286   0x2164             MOVS     R1,#+100
   \   00000288   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   0000028C   0x3030             ADDS     R0,R0,#+48
   \   0000028E   0x.... 0x....      LDR.W    R1,??DataTable11
   \   00000292   0x7148             STRB     R0,[R1, #+5]
    265          
    266            h_add=(next_cluster[0]&0x00FF0000)>>16;
   \   00000294   0x.... 0x....      LDR.W    R0,??DataTable12_1
   \   00000298   0x6800             LDR      R0,[R0, #+0]
   \   0000029A   0x0C00             LSRS     R0,R0,#+16
   \   0000029C   0xB2C2             UXTB     R2,R0            ;; ZeroExt  R2,R0,#+24,#+24
    267            l_add=next_cluster[0]&0x0000FFFF;   
   \   0000029E   0x.... 0x....      LDR.W    R0,??DataTable12_1
   \   000002A2   0x6800             LDR      R0,[R0, #+0]
    268            
    269            for(i=0,j=0;i<11;i++,j++)
   \   000002A4   0x2400             MOVS     R4,#+0
   \   000002A6   0x2100             MOVS     R1,#+0
   \   000002A8   0xE00D             B.N      ??write_dir_29
    270             {
    271               DBUF[addr+i]=file_name[j];    //ÎÄ¼þÃû
   \                     ??write_dir_30:
   \   000002AA   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000002AC   0xFA14 0xF287      UXTAH    R2,R4,R7
   \   000002B0   0x.... 0x....      LDR.W    R3,??DataTable12
   \   000002B4   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   000002B6   0x.... 0x....      LDR.W    R12,??DataTable11
   \   000002BA   0xF811 0xC00C      LDRB     R12,[R1, R12]
   \   000002BE   0xF802 0xC003      STRB     R12,[R2, R3]
    272             }
   \   000002C2   0x1C64             ADDS     R4,R4,#+1
   \   000002C4   0x1C49             ADDS     R1,R1,#+1
   \                     ??write_dir_29:
   \   000002C6   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000002C8   0x2C0B             CMP      R4,#+11
   \   000002CA   0xD3EE             BCC.N    ??write_dir_30
    273            for(j=0;i<26;i++,j++)
   \   000002CC   0x2100             MOVS     R1,#+0
   \   000002CE   0xE00D             B.N      ??write_dir_31
    274             {
    275               DBUF[addr+i]=file_property[j];         //ÎÄ¼þÊôÐÔ
   \                     ??write_dir_32:
   \   000002D0   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000002D2   0xFA14 0xF287      UXTAH    R2,R4,R7
   \   000002D6   0x.... 0x....      LDR.W    R3,??DataTable12
   \   000002DA   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   000002DC   0x.... 0x....      LDR.W    R12,??DataTable12_2
   \   000002E0   0xF811 0xC00C      LDRB     R12,[R1, R12]
   \   000002E4   0xF802 0xC003      STRB     R12,[R2, R3]
    276             }
   \   000002E8   0x1C64             ADDS     R4,R4,#+1
   \   000002EA   0x1C49             ADDS     R1,R1,#+1
   \                     ??write_dir_31:
   \   000002EC   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000002EE   0x2C1A             CMP      R4,#+26
   \   000002F0   0xD3EE             BCC.N    ??write_dir_32
    277            DBUF[addr+26]=(byte_sd)(l_add&0x00FF);      //Ð´ÈëÎÄ¼þÆðÊ¼´ØµÄµÍ16Î»
   \   000002F2   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   000002F4   0x.... 0x....      LDR.W    R1,??DataTable12
   \   000002F8   0x1879             ADDS     R1,R7,R1
   \   000002FA   0x7688             STRB     R0,[R1, #+26]
    278            DBUF[addr+27]=(byte_sd)((l_add>>8)&0x00FF);  
   \   000002FC   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   000002FE   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000302   0x1879             ADDS     R1,R7,R1
   \   00000304   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000306   0x0A00             LSRS     R0,R0,#+8
   \   00000308   0x76C8             STRB     R0,[R1, #+27]
    279              
    280            file_size=ram_number+(((dword_sd)(cnt_cluster*sector_cluster+p_sector))<<9L);
   \   0000030A   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   0000030E   0x8800             LDRH     R0,[R0, #+0]
   \   00000310   0x.... 0x....      LDR.W    R1,??DataTable12_4
   \   00000314   0x8809             LDRH     R1,[R1, #+0]
   \   00000316   0x.... 0x....      LDR.W    R2,??DataTable9_5
   \   0000031A   0x7812             LDRB     R2,[R2, #+0]
   \   0000031C   0x4351             MULS     R1,R2,R1
   \   0000031E   0x.... 0x....      LDR.W    R2,??DataTable12_5
   \   00000322   0x8812             LDRH     R2,[R2, #+0]
   \   00000324   0xFA11 0xF182      UXTAH    R1,R1,R2
   \   00000328   0x0249             LSLS     R1,R1,#+9
   \   0000032A   0xFA11 0xF080      UXTAH    R0,R1,R0
   \   0000032E   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   00000332   0x6008             STR      R0,[R1, #+0]
    281            if(ram_number!=0) file_size-=512; 
   \   00000334   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   00000338   0x8800             LDRH     R0,[R0, #+0]
   \   0000033A   0x2800             CMP      R0,#+0
   \   0000033C   0xD007             BEQ.N    ??write_dir_33
   \   0000033E   0x.... 0x....      LDR.W    R0,??DataTable12_6
   \   00000342   0x6800             LDR      R0,[R0, #+0]
   \   00000344   0xF5B0 0x7000      SUBS     R0,R0,#+512
   \   00000348   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   0000034C   0x6008             STR      R0,[R1, #+0]
    282            DBUF[addr+28]=(byte_sd)(file_size&0x000000ff);        //ÎÄ¼þ´óÐ¡
   \                     ??write_dir_33:
   \   0000034E   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   00000350   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000354   0x1838             ADDS     R0,R7,R0
   \   00000356   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   0000035A   0x6809             LDR      R1,[R1, #+0]
   \   0000035C   0x7701             STRB     R1,[R0, #+28]
    283            DBUF[addr+29]=(byte_sd)((file_size&0x0000ff00)>>8);
   \   0000035E   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   00000360   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000364   0x1838             ADDS     R0,R7,R0
   \   00000366   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   0000036A   0x6809             LDR      R1,[R1, #+0]
   \   0000036C   0x0A09             LSRS     R1,R1,#+8
   \   0000036E   0x7741             STRB     R1,[R0, #+29]
    284            DBUF[addr+30]=(byte_sd)((file_size&0x00ff0000)>>16);
   \   00000370   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   00000372   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000376   0x1838             ADDS     R0,R7,R0
   \   00000378   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   0000037C   0x6809             LDR      R1,[R1, #+0]
   \   0000037E   0x0C09             LSRS     R1,R1,#+16
   \   00000380   0x7781             STRB     R1,[R0, #+30]
    285            DBUF[addr+31]=(byte_sd)((file_size&0xff000000)>>24);
   \   00000382   0xB2BF             UXTH     R7,R7            ;; ZeroExt  R7,R7,#+16,#+16
   \   00000384   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000388   0x1838             ADDS     R0,R7,R0
   \   0000038A   0x.... 0x....      LDR.W    R1,??DataTable12_6
   \   0000038E   0x6809             LDR      R1,[R1, #+0]
   \   00000390   0x0E09             LSRS     R1,R1,#+24
   \   00000392   0x77C1             STRB     R1,[R0, #+31]
   \   00000394   0xE011             B.N      ??write_dir_34
    286          
    287            while(sd_writesingleblock(DBUF,add_dir+addh)&&retry<1000) //Ð´¸ùÄ¿Â¼
    288             {
    289               C_WDOG(); //Çå¿ªÃÅ¹· 
   \                     ??write_dir_35:
   \   00000396   0xB672             CPSID i          
   \   00000398   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   0000039C   0xF24A 0x6102      MOVW     R1,#+42498
   \   000003A0   0x8001             STRH     R1,[R0, #+0]
   \   000003A2   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   000003A6   0xF24B 0x4180      MOVW     R1,#+46208
   \   000003AA   0x8001             STRH     R1,[R0, #+0]
   \   000003AC   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   000003B0   0x7800             LDRB     R0,[R0, #+0]
   \   000003B2   0x2800             CMP      R0,#+0
   \   000003B4   0xD000             BEQ.N    ??write_dir_36
   \   000003B6   0xB662             CPSIE i          
    290               retry++;
   \                     ??write_dir_36:
   \   000003B8   0x1C6D             ADDS     R5,R5,#+1
    291             }
   \                     ??write_dir_34:
   \   000003BA   0x.... 0x....      LDR.W    R0,??DataTable9_1
   \   000003BE   0x6800             LDR      R0,[R0, #+0]
   \   000003C0   0xFA10 0xF186      UXTAH    R1,R0,R6
   \   000003C4   0x.... 0x....      LDR.W    R0,??DataTable12
   \   000003C8   0x.... 0x....      BL       sd_writesingleblock
   \   000003CC   0x2800             CMP      R0,#+0
   \   000003CE   0xD004             BEQ.N    ??write_dir_37
   \   000003D0   0xF44F 0x707A      MOV      R0,#+1000
   \   000003D4   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   000003D6   0x4285             CMP      R5,R0
   \   000003D8   0xD3DD             BCC.N    ??write_dir_35
    292          }
   \                     ??write_dir_37:
   \                     ??write_dir_26:
   \   000003DA   0xE8BD 0x81F0      POP      {R4-R8,PC}       ;; return
    293          /***********************************************************************/
    294          //function:write_fat
    295          //description:Ð´SD¿¨µÄfat1£¬fat2±í(Ëã·¨ºÜ¸´ÔÓ£¬Ðë×ÐÏ¸Ë¼¿¼·ÖÎö)
    296          //ÐÞ¸Ä£º Sword
    297          /***********************************************************************/

   \                                 In section .text, align 4, keep-with-next
    298          void write_fat(void)
    299          {
   \                     write_fat:
   \   00000000   0xE92D 0x47F0      PUSH     {R4-R10,LR}
    300            dword_sd sector=0,cluster;        
   \   00000004   0x2700             MOVS     R7,#+0
    301            word_sd  i=0,p,retry=0,num,k,j;
   \   00000006   0x2600             MOVS     R6,#+0
   \   00000008   0xF05F 0x0800      MOVS     R8,#+0
    302            byte_sd  r1;
    303                                                 
    304            num=cnt_cluster;
   \   0000000C   0x.... 0x....      LDR.W    R0,??DataTable12_4
   \   00000010   0x8805             LDRH     R5,[R0, #+0]
    305            if(p_sector!=0) num++;
   \   00000012   0x.... 0x....      LDR.W    R0,??DataTable12_5
   \   00000016   0x8800             LDRH     R0,[R0, #+0]
   \   00000018   0x2800             CMP      R0,#+0
   \   0000001A   0xD000             BEQ.N    ??write_fat_0
   \   0000001C   0x1C6D             ADDS     R5,R5,#+1
    306            
    307            k=j=0;
   \                     ??write_fat_0:
   \   0000001E   0xF05F 0x0900      MOVS     R9,#+0
   \   00000022   0x464C             MOV      R4,R9
    308            num_segcluster=(next_cluster[0]&0xFF000000)>>24;
   \   00000024   0x.... 0x....      LDR.W    R0,??DataTable12_1
   \   00000028   0x6800             LDR      R0,[R0, #+0]
   \   0000002A   0x0E00             LSRS     R0,R0,#+24
   \   0000002C   0x.... 0x....      LDR.W    R1,??DataTable13
   \   00000030   0x7008             STRB     R0,[R1, #+0]
    309            cluster=next_cluster[0]&0x00FFFFFF;
   \   00000032   0x.... 0x....      LDR.W    R0,??DataTable12_1
   \   00000036   0x6800             LDR      R0,[R0, #+0]
   \   00000038   0xEA5F 0x2A00      LSLS     R10,R0,#+8       ;; ZeroExtS R10,R0,#+8,#+8
   \   0000003C   0xEA5F 0x2A1A      LSRS     R10,R10,#+8
    310            
    311            for(i=0;i<num;i++)
   \   00000040   0x2600             MOVS     R6,#+0
   \   00000042   0xE025             B.N      ??write_fat_1
    312             {
    313               if((cluster>>7)!=sector||i==0)
    314                { 
    315                  if(i!=0) 
    316                   {  //Ð´fat±í
    317                     while(sd_writesingleblock(DBUF,add_f1+sector)&&(retry<1000))
    318                      {
    319                         C_WDOG(); //Çå¿ªÃÅ¹· 
    320                         retry++;
    321                      }
    322                     retry=0;
    323                     while(sd_writesingleblock(DBUF,add_f2+sector)&&(retry<1000)) 
    324                      {
    325                        C_WDOG(); //Çå¿ªÃÅ¹· 
    326                        retry++;
    327                      }
    328                     retry=0;
    329                   }
    330                
    331                  sector=(cluster>>7);
    332                  
    333                  do     //ÏÈ¶ÁÔÙ°ÑÓÃµ½µÄÐÂ´Ø¸ÄÐ´,´Ó¶ø±£Ö¤²»»á¸ü¸ÄÔ­À´µÄÎÄ¼þ
    334                   {
    335                     r1=sd_readsingleblock(DBUF,add_f1+sector);
    336                     C_WDOG();
    337                     retry++;
    338                   } while(r1!=0x00&&retry<100);
    339                  retry=0;
    340                }
    341               
    342               p=((cluster&0x007F)<<2);      //ÕÒµ½µ±Ç°´Ø¶ÔÓ¦µÄFAT±íµÄÎ»ÖÃ
    343               
    344               j++;        //ÕÒµ½ÏÂÒ»¸öÓÐÓÃ´Ø
    345               if(j==num_segcluster)
    346                {
    347                  j=0;
    348                  num_segcluster=(next_cluster[++k]&0xFF000000)>>24;
    349                  cluster=next_cluster[k]&0x00FFFFFF; 
    350                }
    351               else
    352                {
    353                  cluster++;
    354                }
    355               
    356               DBUF[p]=(byte_sd)(cluster&0x00FF); //Ð´ÈëÎÄ¼þµÄÏÂÒ»¸ö´Ø
    357               DBUF[p+1]=(byte_sd)((cluster>>8)&0x00FF);
    358               DBUF[p+2]=(byte_sd)((cluster>>16)&0x00FF);
    359               
    360               if(i==(num-1))
    361                {
    362                  DBUF[p]=0xff;
    363                  DBUF[p+1]=0xff;
    364                  DBUF[p+2]=0xff;
    365                  DBUF[p+3]=0x0f;
    366                  while(sd_writesingleblock(DBUF,add_f1+sector)&&(retry<1000))
    367                   {
    368                      C_WDOG(); //Çå¿ªÃÅ¹· 
    369                      retry++;
    370                   }
    371                  retry=0;
    372                  while(sd_writesingleblock(DBUF,add_f2+sector)&&(retry<1000)) 
    373                   {
    374                     C_WDOG(); //Çå¿ªÃÅ¹· 
   \                     ??write_fat_2:
   \   00000044   0xB672             CPSID i          
   \   00000046   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   0000004A   0xF24A 0x6102      MOVW     R1,#+42498
   \   0000004E   0x8001             STRH     R1,[R0, #+0]
   \   00000050   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000054   0xF24B 0x4180      MOVW     R1,#+46208
   \   00000058   0x8001             STRH     R1,[R0, #+0]
   \   0000005A   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   0000005E   0x7800             LDRB     R0,[R0, #+0]
   \   00000060   0x2800             CMP      R0,#+0
   \   00000062   0xD000             BEQ.N    ??write_fat_3
   \   00000064   0xB662             CPSIE i          
    375                     retry++;
   \                     ??write_fat_3:
   \   00000066   0xF118 0x0801      ADDS     R8,R8,#+1
    376                   }
   \                     ??write_fat_4:
   \   0000006A   0x.... 0x....      LDR.W    R0,??DataTable13_1
   \   0000006E   0x6800             LDR      R0,[R0, #+0]
   \   00000070   0x1839             ADDS     R1,R7,R0
   \   00000072   0x.... 0x....      LDR.W    R0,??DataTable13_2
   \   00000076   0x.... 0x....      BL       sd_writesingleblock
   \   0000007A   0x2800             CMP      R0,#+0
   \   0000007C   0xD005             BEQ.N    ??write_fat_5
   \   0000007E   0xF44F 0x707A      MOV      R0,#+1000
   \   00000082   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   00000086   0x4580             CMP      R8,R0
   \   00000088   0xD3DC             BCC.N    ??write_fat_2
    377                  retry=0;
   \                     ??write_fat_5:
   \   0000008A   0xF05F 0x0800      MOVS     R8,#+0
   \                     ??write_fat_6:
   \   0000008E   0x1C76             ADDS     R6,R6,#+1
   \                     ??write_fat_1:
   \   00000090   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   00000092   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   00000094   0x42AE             CMP      R6,R5
   \   00000096   0xF080 0x80F9      BCS.W    ??write_fat_7
   \   0000009A   0xEA5F 0x10DA      LSRS     R0,R10,#+7
   \   0000009E   0x42B8             CMP      R0,R7
   \   000000A0   0xD102             BNE.N    ??write_fat_8
   \   000000A2   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   000000A4   0x2E00             CMP      R6,#+0
   \   000000A6   0xD175             BNE.N    ??write_fat_9
   \                     ??write_fat_8:
   \   000000A8   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   000000AA   0x2E00             CMP      R6,#+0
   \   000000AC   0xD113             BNE.N    ??write_fat_10
   \   000000AE   0xE04A             B.N      ??write_fat_11
   \                     ??write_fat_12:
   \   000000B0   0xB672             CPSID i          
   \   000000B2   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   000000B6   0xF24A 0x6102      MOVW     R1,#+42498
   \   000000BA   0x8001             STRH     R1,[R0, #+0]
   \   000000BC   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   000000C0   0xF24B 0x4180      MOVW     R1,#+46208
   \   000000C4   0x8001             STRH     R1,[R0, #+0]
   \   000000C6   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   000000CA   0x7800             LDRB     R0,[R0, #+0]
   \   000000CC   0x2800             CMP      R0,#+0
   \   000000CE   0xD000             BEQ.N    ??write_fat_13
   \   000000D0   0xB662             CPSIE i          
   \                     ??write_fat_13:
   \   000000D2   0xF118 0x0801      ADDS     R8,R8,#+1
   \                     ??write_fat_10:
   \   000000D6   0x.... 0x....      LDR.W    R0,??DataTable13_3
   \   000000DA   0x6800             LDR      R0,[R0, #+0]
   \   000000DC   0x1839             ADDS     R1,R7,R0
   \   000000DE   0x.... 0x....      LDR.W    R0,??DataTable13_2
   \   000000E2   0x.... 0x....      BL       sd_writesingleblock
   \   000000E6   0x2800             CMP      R0,#+0
   \   000000E8   0xD005             BEQ.N    ??write_fat_14
   \   000000EA   0xF44F 0x707A      MOV      R0,#+1000
   \   000000EE   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   000000F2   0x4580             CMP      R8,R0
   \   000000F4   0xD3DC             BCC.N    ??write_fat_12
   \                     ??write_fat_14:
   \   000000F6   0xF05F 0x0800      MOVS     R8,#+0
   \   000000FA   0xE012             B.N      ??write_fat_15
   \                     ??write_fat_16:
   \   000000FC   0xB672             CPSID i          
   \   000000FE   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000102   0xF24A 0x6102      MOVW     R1,#+42498
   \   00000106   0x8001             STRH     R1,[R0, #+0]
   \   00000108   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   0000010C   0xF24B 0x4180      MOVW     R1,#+46208
   \   00000110   0x8001             STRH     R1,[R0, #+0]
   \   00000112   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   00000116   0x7800             LDRB     R0,[R0, #+0]
   \   00000118   0x2800             CMP      R0,#+0
   \   0000011A   0xD000             BEQ.N    ??write_fat_17
   \   0000011C   0xB662             CPSIE i          
   \                     ??write_fat_17:
   \   0000011E   0xF118 0x0801      ADDS     R8,R8,#+1
   \                     ??write_fat_15:
   \   00000122   0x.... 0x....      LDR.W    R0,??DataTable13_1
   \   00000126   0x6800             LDR      R0,[R0, #+0]
   \   00000128   0x1839             ADDS     R1,R7,R0
   \   0000012A   0x.... 0x....      LDR.W    R0,??DataTable13_2
   \   0000012E   0x.... 0x....      BL       sd_writesingleblock
   \   00000132   0x2800             CMP      R0,#+0
   \   00000134   0xD005             BEQ.N    ??write_fat_18
   \   00000136   0xF44F 0x707A      MOV      R0,#+1000
   \   0000013A   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   0000013E   0x4580             CMP      R8,R0
   \   00000140   0xD3DC             BCC.N    ??write_fat_16
   \                     ??write_fat_18:
   \   00000142   0xF05F 0x0800      MOVS     R8,#+0
   \                     ??write_fat_11:
   \   00000146   0xEA5F 0x17DA      LSRS     R7,R10,#+7
   \                     ??write_fat_19:
   \   0000014A   0x.... 0x....      LDR.W    R0,??DataTable13_3
   \   0000014E   0x6800             LDR      R0,[R0, #+0]
   \   00000150   0x1839             ADDS     R1,R7,R0
   \   00000152   0x.... 0x....      LDR.W    R0,??DataTable13_2
   \   00000156   0x.... 0x....      BL       sd_readsingleblock
   \   0000015A   0xB672             CPSID i          
   \   0000015C   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000160   0xF24A 0x6202      MOVW     R2,#+42498
   \   00000164   0x800A             STRH     R2,[R1, #+0]
   \   00000166   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   0000016A   0xF24B 0x4280      MOVW     R2,#+46208
   \   0000016E   0x800A             STRH     R2,[R1, #+0]
   \   00000170   0x.... 0x....      LDR.W    R1,??DataTable9_3
   \   00000174   0x7809             LDRB     R1,[R1, #+0]
   \   00000176   0x2900             CMP      R1,#+0
   \   00000178   0xD000             BEQ.N    ??write_fat_20
   \   0000017A   0xB662             CPSIE i          
   \                     ??write_fat_20:
   \   0000017C   0xF118 0x0801      ADDS     R8,R8,#+1
   \   00000180   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000182   0x2800             CMP      R0,#+0
   \   00000184   0xD004             BEQ.N    ??write_fat_21
   \   00000186   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   0000018A   0xF1B8 0x0F64      CMP      R8,#+100
   \   0000018E   0xD3DC             BCC.N    ??write_fat_19
   \                     ??write_fat_21:
   \   00000190   0xF05F 0x0800      MOVS     R8,#+0
   \                     ??write_fat_9:
   \   00000194   0xF01A 0x007F      ANDS     R0,R10,#0x7F
   \   00000198   0x0080             LSLS     R0,R0,#+2
   \   0000019A   0x1C64             ADDS     R4,R4,#+1
   \   0000019C   0x.... 0x....      LDR.W    R1,??DataTable13
   \   000001A0   0x7809             LDRB     R1,[R1, #+0]
   \   000001A2   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   000001A4   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   000001A6   0x428C             CMP      R4,R1
   \   000001A8   0xD117             BNE.N    ??write_fat_22
   \   000001AA   0x2400             MOVS     R4,#+0
   \   000001AC   0xF119 0x0101      ADDS     R1,R9,#+1
   \   000001B0   0x4689             MOV      R9,R1
   \   000001B2   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   000001B4   0x.... 0x....      LDR.W    R2,??DataTable12_1
   \   000001B8   0xF852 0x1021      LDR      R1,[R2, R1, LSL #+2]
   \   000001BC   0x0E09             LSRS     R1,R1,#+24
   \   000001BE   0x.... 0x....      LDR.W    R2,??DataTable13
   \   000001C2   0x7011             STRB     R1,[R2, #+0]
   \   000001C4   0xFA1F 0xF989      UXTH     R9,R9            ;; ZeroExt  R9,R9,#+16,#+16
   \   000001C8   0x.... 0x....      LDR.W    R1,??DataTable12_1
   \   000001CC   0xF851 0x1029      LDR      R1,[R1, R9, LSL #+2]
   \   000001D0   0xEA5F 0x2A01      LSLS     R10,R1,#+8       ;; ZeroExtS R10,R1,#+8,#+8
   \   000001D4   0xEA5F 0x2A1A      LSRS     R10,R10,#+8
   \   000001D8   0xE001             B.N      ??write_fat_23
   \                     ??write_fat_22:
   \   000001DA   0xF11A 0x0A01      ADDS     R10,R10,#+1
   \                     ??write_fat_23:
   \   000001DE   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001E0   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   000001E4   0xF800 0xA001      STRB     R10,[R0, R1]
   \   000001E8   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001EA   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   000001EE   0x1841             ADDS     R1,R0,R1
   \   000001F0   0xEA5F 0x221A      LSRS     R2,R10,#+8
   \   000001F4   0x704A             STRB     R2,[R1, #+1]
   \   000001F6   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   000001F8   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   000001FC   0x1841             ADDS     R1,R0,R1
   \   000001FE   0xEA5F 0x421A      LSRS     R2,R10,#+16
   \   00000202   0x708A             STRB     R2,[R1, #+2]
   \   00000204   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   00000206   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   00000208   0x1E69             SUBS     R1,R5,#+1
   \   0000020A   0x428E             CMP      R6,R1
   \   0000020C   0xF47F 0xAF3F      BNE.W    ??write_fat_6
   \   00000210   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000212   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   00000216   0x22FF             MOVS     R2,#+255
   \   00000218   0x5442             STRB     R2,[R0, R1]
   \   0000021A   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000021C   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   00000220   0x1841             ADDS     R1,R0,R1
   \   00000222   0x22FF             MOVS     R2,#+255
   \   00000224   0x704A             STRB     R2,[R1, #+1]
   \   00000226   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000228   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   0000022C   0x1841             ADDS     R1,R0,R1
   \   0000022E   0x22FF             MOVS     R2,#+255
   \   00000230   0x708A             STRB     R2,[R1, #+2]
   \   00000232   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000234   0x.... 0x....      LDR.W    R1,??DataTable13_2
   \   00000238   0x1840             ADDS     R0,R0,R1
   \   0000023A   0x210F             MOVS     R1,#+15
   \   0000023C   0x70C1             STRB     R1,[R0, #+3]
   \   0000023E   0xE012             B.N      ??write_fat_24
   \                     ??write_fat_25:
   \   00000240   0xB672             CPSID i          
   \   00000242   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000246   0xF24A 0x6102      MOVW     R1,#+42498
   \   0000024A   0x8001             STRH     R1,[R0, #+0]
   \   0000024C   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000250   0xF24B 0x4180      MOVW     R1,#+46208
   \   00000254   0x8001             STRH     R1,[R0, #+0]
   \   00000256   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   0000025A   0x7800             LDRB     R0,[R0, #+0]
   \   0000025C   0x2800             CMP      R0,#+0
   \   0000025E   0xD000             BEQ.N    ??write_fat_26
   \   00000260   0xB662             CPSIE i          
   \                     ??write_fat_26:
   \   00000262   0xF118 0x0801      ADDS     R8,R8,#+1
   \                     ??write_fat_24:
   \   00000266   0x.... 0x....      LDR.W    R0,??DataTable13_3
   \   0000026A   0x6800             LDR      R0,[R0, #+0]
   \   0000026C   0x1839             ADDS     R1,R7,R0
   \   0000026E   0x.... 0x....      LDR.W    R0,??DataTable13_2
   \   00000272   0x.... 0x....      BL       sd_writesingleblock
   \   00000276   0x2800             CMP      R0,#+0
   \   00000278   0xD005             BEQ.N    ??write_fat_27
   \   0000027A   0xF44F 0x707A      MOV      R0,#+1000
   \   0000027E   0xFA1F 0xF888      UXTH     R8,R8            ;; ZeroExt  R8,R8,#+16,#+16
   \   00000282   0x4580             CMP      R8,R0
   \   00000284   0xD3DC             BCC.N    ??write_fat_25
   \                     ??write_fat_27:
   \   00000286   0xF05F 0x0800      MOVS     R8,#+0
   \   0000028A   0xE6EE             B.N      ??write_fat_4
    378                }
    379             }
    380          }
   \                     ??write_fat_7:
   \   0000028C   0xE8BD 0x87F0      POP      {R4-R10,PC}      ;; return
    381          
    382          /*********************************************************/
    383          //function:writeram_sd
    384          //description:Ð´ram512×Ö½ÚÊý¾Ýµ½sd¿¨ÉÈÇøº¯Êý
    385          //ÐÞ¸Ä£º Sword
    386          /***********************************************************/

   \                                 In section .text, align 4, keep-with-next
    387          void writeram_sd(void)
    388          {
   \                     writeram_sd:
   \   00000000   0xB510             PUSH     {R4,LR}
    389            word_sd retry=0;
   \   00000002   0x2400             MOVS     R4,#+0
   \   00000004   0xE011             B.N      ??writeram_sd_0
    390          #ifdef EN_SDbuf
    391            while(SD_WriteBlock_UserBuf()&&(retry<300)) 
    392             {
    393               C_WDOG(); //Çå¿ªÃÅ¹· 
   \                     ??writeram_sd_1:
   \   00000006   0xB672             CPSID i          
   \   00000008   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   0000000C   0xF24A 0x6102      MOVW     R1,#+42498
   \   00000010   0x8001             STRH     R1,[R0, #+0]
   \   00000012   0x.... 0x....      LDR.W    R0,??DataTable9_2  ;; 0x4005200c
   \   00000016   0xF24B 0x4180      MOVW     R1,#+46208
   \   0000001A   0x8001             STRH     R1,[R0, #+0]
   \   0000001C   0x.... 0x....      LDR.W    R0,??DataTable9_3
   \   00000020   0x7800             LDRB     R0,[R0, #+0]
   \   00000022   0x2800             CMP      R0,#+0
   \   00000024   0xD000             BEQ.N    ??writeram_sd_2
   \   00000026   0xB662             CPSIE i          
    394               retry++;
   \                     ??writeram_sd_2:
   \   00000028   0x1C64             ADDS     R4,R4,#+1
    395             }
   \                     ??writeram_sd_0:
   \   0000002A   0x.... 0x....      BL       SD_WriteBlock_UserBuf
   \   0000002E   0x2800             CMP      R0,#+0
   \   00000030   0xD004             BEQ.N    ??writeram_sd_3
   \   00000032   0xF44F 0x7096      MOV      R0,#+300
   \   00000036   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000038   0x4284             CMP      R4,R0
   \   0000003A   0xD3E4             BCC.N    ??writeram_sd_1
    396          #else                  
    397            while(sd_writesingleblock(DBUF,p_datasector)&&(retry<300)) 
    398             {
    399               C_WDOG(); //Çå¿ªÃÅ¹· 
    400               retry++;
    401             }
    402          #endif   
    403            if((++p_sector)==sector_cluster)  //Ð´ÍêÒ»´ØµÄ´¦Àí
   \                     ??writeram_sd_3:
   \   0000003C   0x.... 0x....      LDR.W    R0,??DataTable12_5
   \   00000040   0x8800             LDRH     R0,[R0, #+0]
   \   00000042   0x1C40             ADDS     R0,R0,#+1
   \   00000044   0x.... 0x....      LDR.W    R1,??DataTable12_5
   \   00000048   0x8008             STRH     R0,[R1, #+0]
   \   0000004A   0x.... 0x....      LDR.W    R1,??DataTable9_5
   \   0000004E   0x7809             LDRB     R1,[R1, #+0]
   \   00000050   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000052   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   00000054   0x4288             CMP      R0,R1
   \   00000056   0xD14B             BNE.N    ??writeram_sd_4
    404             {
    405               p_sector=0;
   \   00000058   0x.... 0x....      LDR.W    R0,??DataTable12_5
   \   0000005C   0x2100             MOVS     R1,#+0
   \   0000005E   0x8001             STRH     R1,[R0, #+0]
    406               p_cluster++;
   \   00000060   0x.... 0x....      LDR.W    R0,??DataTable13_4
   \   00000064   0x7800             LDRB     R0,[R0, #+0]
   \   00000066   0x1C40             ADDS     R0,R0,#+1
   \   00000068   0x.... 0x....      LDR.W    R1,??DataTable13_4
   \   0000006C   0x7008             STRB     R0,[R1, #+0]
    407               cnt_cluster++;
   \   0000006E   0x.... 0x....      LDR.W    R0,??DataTable12_4
   \   00000072   0x8800             LDRH     R0,[R0, #+0]
   \   00000074   0x1C40             ADDS     R0,R0,#+1
   \   00000076   0x.... 0x....      LDR.W    R1,??DataTable12_4
   \   0000007A   0x8008             STRH     R0,[R1, #+0]
    408               if(p_cluster==num_segcluster)
   \   0000007C   0x.... 0x....      LDR.W    R0,??DataTable13_4
   \   00000080   0x7800             LDRB     R0,[R0, #+0]
   \   00000082   0x.... 0x....      LDR.W    R1,??DataTable13
   \   00000086   0x7809             LDRB     R1,[R1, #+0]
   \   00000088   0x4288             CMP      R0,R1
   \   0000008A   0xD129             BNE.N    ??writeram_sd_5
    409                {       //Èç¹ûÒ»¸ö´Ø×éÐ´Íê,½«Ð´ÈëÖ¸ÕëÖ¸ÏòÏÂÒ»´Ø×éµÄÆðÊ¼µØÖ·
    410                  p_datasector=((dword_sd)((next_cluster[++p_segcluster]&0x00FFFFFF)-2))*sector_cluster+add_dir; 
   \   0000008C   0x.... 0x....      LDR.W    R0,??DataTable13_5
   \   00000090   0x8800             LDRH     R0,[R0, #+0]
   \   00000092   0x1C40             ADDS     R0,R0,#+1
   \   00000094   0x.... 0x....      LDR.W    R1,??DataTable13_5
   \   00000098   0x8008             STRH     R0,[R1, #+0]
   \   0000009A   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000009C   0x.... 0x....      LDR.W    R1,??DataTable12_1
   \   000000A0   0xF851 0x0020      LDR      R0,[R1, R0, LSL #+2]
   \   000000A4   0x0200             LSLS     R0,R0,#+8        ;; ZeroExtS R0,R0,#+8,#+8
   \   000000A6   0x0A00             LSRS     R0,R0,#+8
   \   000000A8   0x1E80             SUBS     R0,R0,#+2
   \   000000AA   0x.... 0x....      LDR.W    R1,??DataTable9_5
   \   000000AE   0x7809             LDRB     R1,[R1, #+0]
   \   000000B0   0x.... 0x....      LDR.W    R2,??DataTable9_1
   \   000000B4   0x6812             LDR      R2,[R2, #+0]
   \   000000B6   0xFB01 0x2000      MLA      R0,R1,R0,R2
   \   000000BA   0x.... 0x....      LDR.W    R1,??DataTable10
   \   000000BE   0x6008             STR      R0,[R1, #+0]
    411                  num_segcluster=(next_cluster[p_segcluster]&0xFF000000)>>24;
   \   000000C0   0x.... 0x....      LDR.W    R0,??DataTable13_5
   \   000000C4   0x8800             LDRH     R0,[R0, #+0]
   \   000000C6   0x.... 0x....      LDR.W    R1,??DataTable12_1
   \   000000CA   0xF851 0x0020      LDR      R0,[R1, R0, LSL #+2]
   \   000000CE   0x0E00             LSRS     R0,R0,#+24
   \   000000D0   0x.... 0x....      LDR.W    R1,??DataTable13
   \   000000D4   0x7008             STRB     R0,[R1, #+0]
    412                  p_cluster=0;
   \   000000D6   0x.... 0x....      LDR.W    R0,??DataTable13_4
   \   000000DA   0x2100             MOVS     R1,#+0
   \   000000DC   0x7001             STRB     R1,[R0, #+0]
   \   000000DE   0xE00E             B.N      ??writeram_sd_6
    413                }
    414               else
    415                {
    416                  p_datasector++;
   \                     ??writeram_sd_5:
   \   000000E0   0x.... 0x....      LDR.W    R0,??DataTable10
   \   000000E4   0x6800             LDR      R0,[R0, #+0]
   \   000000E6   0x1C40             ADDS     R0,R0,#+1
   \   000000E8   0x.... 0x....      LDR.W    R1,??DataTable10
   \   000000EC   0x6008             STR      R0,[R1, #+0]
   \   000000EE   0xE006             B.N      ??writeram_sd_6
    417                }
    418             }
    419            else
    420             {
    421               p_datasector++;
   \                     ??writeram_sd_4:
   \   000000F0   0x.... 0x....      LDR.W    R0,??DataTable10
   \   000000F4   0x6800             LDR      R0,[R0, #+0]
   \   000000F6   0x1C40             ADDS     R0,R0,#+1
   \   000000F8   0x.... 0x....      LDR.W    R1,??DataTable10
   \   000000FC   0x6008             STR      R0,[R1, #+0]
    422             }
    423          }
   \                     ??writeram_sd_6:
   \   000000FE   0xBD10             POP      {R4,PC}          ;; return
    424          /*********************************************************/
    425          //function:write_ram
    426          //description:Ð´×Ö½ÚÊý¾Ýµ½ramº¯Êý£¨Ö÷º¯ÊýÓëfat32ÎÄ¼þÏµÍ³º¯ÊýµÄ½Ó¿Ú£©
    427          //ÐÞ¸Ä£º Sword
    428          /***********************************************************/

   \                                 In section .text, align 2, keep-with-next
    429          void writebyte_ram(byte_sd wdata)
    430          {
   \                     writebyte_ram:
   \   00000000   0xB580             PUSH     {R7,LR}
    431            
    432            if(cnt_cluster<cluster_number)
   \   00000002   0x.... 0x....      LDR.W    R1,??DataTable12_4
   \   00000006   0x8809             LDRH     R1,[R1, #+0]
   \   00000008   0x.... 0x....      LDR.W    R2,??DataTable13_6
   \   0000000C   0x8812             LDRH     R2,[R2, #+0]
   \   0000000E   0x4291             CMP      R1,R2
   \   00000010   0xD21A             BCS.N    ??writebyte_ram_0
    433             {
    434          #ifdef EN_SDbuf
    435               pBuf_Now[ram_number]=wdata;
   \   00000012   0x.... 0x....      LDR.W    R1,??DataTable12_3
   \   00000016   0x8809             LDRH     R1,[R1, #+0]
   \   00000018   0x.... 0x....      LDR.W    R2,??DataTable9
   \   0000001C   0x6812             LDR      R2,[R2, #+0]
   \   0000001E   0x5488             STRB     R0,[R1, R2]
    436          #else
    437               DBUF[ram_number]=wdata;
    438          #endif     
    439               ram_number++;
   \   00000020   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   00000024   0x8800             LDRH     R0,[R0, #+0]
   \   00000026   0x1C40             ADDS     R0,R0,#+1
   \   00000028   0x.... 0x....      LDR.W    R1,??DataTable12_3
   \   0000002C   0x8008             STRH     R0,[R1, #+0]
    440               if(ram_number==512) 
   \   0000002E   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   00000032   0x8800             LDRH     R0,[R0, #+0]
   \   00000034   0xF44F 0x7100      MOV      R1,#+512
   \   00000038   0x4288             CMP      R0,R1
   \   0000003A   0xD105             BNE.N    ??writebyte_ram_0
    441                {
    442                  ram_number=0;
   \   0000003C   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   00000040   0x2100             MOVS     R1,#+0
   \   00000042   0x8001             STRH     R1,[R0, #+0]
    443                  writeram_sd();
   \   00000044   0x.... 0x....      BL       writeram_sd
    444                }
    445             }
    446          }
   \                     ??writebyte_ram_0:
   \   00000048   0xBD01             POP      {R0,PC}          ;; return
    447          /*********************************************************/
    448          //function:write_stop
    449          //description:Ð´SD¿¨½áÊø£¬Íê³ÉºóÐø¹¤×÷£¬¼´Ð´FAT±íÓë¸ùÄ¿Â¼
    450          //ÐÞ¸Ä£º Sword
    451          /*********************************************************/

   \                                 In section .text, align 2, keep-with-next
    452          void write_stop(void)
    453          {
   \                     write_stop:
   \   00000000   0xB580             PUSH     {R7,LR}
    454             if(cnt_cluster==0&&p_sector==0&&ram_number==0) 
   \   00000002   0x.... 0x....      LDR.W    R0,??DataTable12_4
   \   00000006   0x8800             LDRH     R0,[R0, #+0]
   \   00000008   0x.... 0x....      LDR.W    R1,??DataTable12_5
   \   0000000C   0x8809             LDRH     R1,[R1, #+0]
   \   0000000E   0x4308             ORRS     R0,R1,R0
   \   00000010   0x.... 0x....      LDR.W    R1,??DataTable12_3
   \   00000014   0x8809             LDRH     R1,[R1, #+0]
   \   00000016   0x4308             ORRS     R0,R1,R0
   \   00000018   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000001A   0x2800             CMP      R0,#+0
   \   0000001C   0xD011             BEQ.N    ??write_stop_0
    455             {
    456               return; //Èç¹ûÃ»ÓÐÐ´¹ýÊý¾Ý,Ôò²»Ð´fat±íºÍ¸ùÄ¿Â¼
    457             }
    458             
    459             if(ram_number!=0) writeram_sd(); 
   \                     ??write_stop_1:
   \   0000001E   0x.... 0x....      LDR.W    R0,??DataTable12_3
   \   00000022   0x8800             LDRH     R0,[R0, #+0]
   \   00000024   0x2800             CMP      R0,#+0
   \   00000026   0xD001             BEQ.N    ??write_stop_2
   \   00000028   0x.... 0x....      BL       writeram_sd
    460           //°Ñ×îºó²»¹»Ò»¸öÍêÕûÉÈÇøµÄÊý¾ÝÐ´Èë
    461           
    462          #ifdef EN_SDbuf
    463             SD_ClrBuf();
   \                     ??write_stop_2:
   \   0000002C   0x.... 0x....      BL       SD_ClrBuf
    464          #endif
    465             
    466             write_dir();
   \   00000030   0x.... 0x....      BL       write_dir
    467             write_fat(); 
   \   00000034   0x.... 0x....      BL       write_fat
    468          
    469             Wait_SDRdy(SD_LONG_Wait);   //µÈ´ý×îºóÒ»¸öÉÈÇøÊý¾ÝÐ´ÈëSD¿¨
   \   00000038   0x....             LDR.N    R0,??DataTable7_4  ;; 0x1e8480
   \   0000003A   0x.... 0x....      BL       Wait_SDRdy
    470          
    471             CloseSD();//¹Ø±ÕSD¿¨  
   \   0000003E   0x.... 0x....      BL       CloseSD
    472          }
   \                     ??write_stop_0:
   \   00000042   0xBD01             POP      {R0,PC}          ;; return
    473          
    474          /*
    475          º¯ÊýÃû³Æ£ºsearch_addr_sd
    476          º¯Êý¹¦ÄÜ£ºÑ°ÕÒsd¿¨Æô¶¯ÉÈÇø,¸ùÄ¿Â¼,Êý¾ÝÉÈÇø,fat1ºÍfat2µÄÊ×µØÖ·
    477          ±à Ð´ Õß£ºSword
    478          */

   \                                 In section .text, align 4, keep-with-next
    479          void search_addr_sd(void)
    480          {
   \                     search_addr_sd:
   \   00000000   0xB538             PUSH     {R3-R5,LR}
    481            word_sd  retry;
    482            byte_sd  r1,flag_yes=1;
   \   00000002   0x2401             MOVS     R4,#+1
    483            
    484            retry=0;
   \   00000004   0x2500             MOVS     R5,#+0
    485            do
    486             {  //¶ÁÈ¡µÚ0ÎïÀíÉÈÇøÄÚÈÝ
    487               r1=sd_readsingleblock(DBUF,0);
   \                     ??search_addr_sd_0:
   \   00000006   0x2100             MOVS     R1,#+0
   \   00000008   0x.... 0x....      LDR.W    R0,??DataTable12
   \   0000000C   0x.... 0x....      BL       sd_readsingleblock
    488               C_WDOG();
   \   00000010   0xB672             CPSID i          
   \   00000012   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000016   0xF24A 0x6202      MOVW     R2,#+42498
   \   0000001A   0x800A             STRH     R2,[R1, #+0]
   \   0000001C   0x.... 0x....      LDR.W    R1,??DataTable9_2  ;; 0x4005200c
   \   00000020   0xF24B 0x4280      MOVW     R2,#+46208
   \   00000024   0x800A             STRH     R2,[R1, #+0]
   \   00000026   0x.... 0x....      LDR.W    R1,??DataTable9_3
   \   0000002A   0x7809             LDRB     R1,[R1, #+0]
   \   0000002C   0x2900             CMP      R1,#+0
   \   0000002E   0xD000             BEQ.N    ??search_addr_sd_1
   \   00000030   0xB662             CPSIE i          
    489               retry++;
   \                     ??search_addr_sd_1:
   \   00000032   0x1C6D             ADDS     R5,R5,#+1
    490             } while(r1!=0x00&&retry<100);
   \   00000034   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000036   0x2800             CMP      R0,#+0
   \   00000038   0xD002             BEQ.N    ??search_addr_sd_2
   \   0000003A   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000003C   0x2D64             CMP      R5,#+100
   \   0000003E   0xD3E2             BCC.N    ??search_addr_sd_0
    491           
    492            if(retry>=100) 
   \                     ??search_addr_sd_2:
   \   00000040   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   00000042   0x2D64             CMP      R5,#+100
   \   00000044   0xD304             BCC.N    ??search_addr_sd_3
    493             {
    494               flag_err_sd=SDERR_ReadOverTime;
   \   00000046   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   0000004A   0x2103             MOVS     R1,#+3
   \   0000004C   0x7001             STRB     R1,[R0, #+0]
    495               flag_yes=0; //³¬Ê±³ö´í
   \   0000004E   0x2400             MOVS     R4,#+0
    496             }
    497               
    498            if(DBUF[0]!=0xeb||DBUF[1]!=0x58||DBUF[2]!=0x90)   
   \                     ??search_addr_sd_3:
   \   00000050   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000054   0x7800             LDRB     R0,[R0, #+0]
   \   00000056   0x28EB             CMP      R0,#+235
   \   00000058   0xD109             BNE.N    ??search_addr_sd_4
   \   0000005A   0x.... 0x....      LDR.W    R0,??DataTable12
   \   0000005E   0x7840             LDRB     R0,[R0, #+1]
   \   00000060   0x2858             CMP      R0,#+88
   \   00000062   0xD104             BNE.N    ??search_addr_sd_4
   \   00000064   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000068   0x7880             LDRB     R0,[R0, #+2]
   \   0000006A   0x2890             CMP      R0,#+144
   \   0000006C   0xD053             BEQ.N    ??search_addr_sd_5
    499           //Í¨¹ýµÚ0ÎïÀíÉÈÇøµÄÇ°3×Ö½ÚÊÇ·ñÊÇÌø×ªÖ¸ÁîÀ´ÅÐ¶¨ÊÇ²»ÊÇÆô¶¯ÉÈÇø    
    500             {
    501               add_sta=DBUF[454]+((dword_sd)DBUF[455]<<8)+((dword_sd)DBUF[456]<<16)+((dword_sd)DBUF[457]<<24);
   \                     ??search_addr_sd_4:
   \   0000006E   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000072   0xF890 0x01C6      LDRB     R0,[R0, #+454]
   \   00000076   0x.... 0x....      LDR.W    R1,??DataTable12
   \   0000007A   0xF891 0x11C7      LDRB     R1,[R1, #+455]
   \   0000007E   0x0209             LSLS     R1,R1,#+8
   \   00000080   0x1808             ADDS     R0,R1,R0
   \   00000082   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000086   0xF891 0x11C8      LDRB     R1,[R1, #+456]
   \   0000008A   0xEB10 0x4001      ADDS     R0,R0,R1, LSL #+16
   \   0000008E   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000092   0xF891 0x11C9      LDRB     R1,[R1, #+457]
   \   00000096   0xEB10 0x6001      ADDS     R0,R0,R1, LSL #+24
   \   0000009A   0x.... 0x....      LDR.W    R1,??DataTable13_8
   \   0000009E   0x6008             STR      R0,[R1, #+0]
    502            //Èç¹ûÎïÀíµÄµÚ0ÉÈÇø²»ÊÇÆô¶¯ÉÈÇø,ÔòÓÉµÚ454-457byte_sdÀ´¼ÆËãÆô¶¯ÉÈÇøµÄÆ«ÒÆÁ¿   
    503               retry=0;   
   \   000000A0   0x2500             MOVS     R5,#+0
    504               do
    505                {  //¶ÁÈ¡Æô¶¯ÉÈÇøÄÚÈÝ
    506                  r1=sd_readsingleblock(DBUF,add_sta);
   \                     ??search_addr_sd_6:
   \   000000A2   0x.... 0x....      LDR.W    R0,??DataTable13_8
   \   000000A6   0x6801             LDR      R1,[R0, #+0]
   \   000000A8   0x.... 0x....      LDR.W    R0,??DataTable12
   \   000000AC   0x.... 0x....      BL       sd_readsingleblock
    507                  C_WDOG();
   \   000000B0   0xB672             CPSID i          
   \   000000B2   0x....             LDR.N    R1,??DataTable9_2  ;; 0x4005200c
   \   000000B4   0xF24A 0x6202      MOVW     R2,#+42498
   \   000000B8   0x800A             STRH     R2,[R1, #+0]
   \   000000BA   0x....             LDR.N    R1,??DataTable9_2  ;; 0x4005200c
   \   000000BC   0xF24B 0x4280      MOVW     R2,#+46208
   \   000000C0   0x800A             STRH     R2,[R1, #+0]
   \   000000C2   0x....             LDR.N    R1,??DataTable9_3
   \   000000C4   0x7809             LDRB     R1,[R1, #+0]
   \   000000C6   0x2900             CMP      R1,#+0
   \   000000C8   0xD000             BEQ.N    ??search_addr_sd_7
   \   000000CA   0xB662             CPSIE i          
    508                  retry++;
   \                     ??search_addr_sd_7:
   \   000000CC   0x1C6D             ADDS     R5,R5,#+1
    509                } while(r1!=0x00&&retry<100);
   \   000000CE   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000D0   0x2800             CMP      R0,#+0
   \   000000D2   0xD002             BEQ.N    ??search_addr_sd_8
   \   000000D4   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   000000D6   0x2D64             CMP      R5,#+100
   \   000000D8   0xD3E3             BCC.N    ??search_addr_sd_6
    510               
    511               if(retry>=100) 
   \                     ??search_addr_sd_8:
   \   000000DA   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   000000DC   0x2D64             CMP      R5,#+100
   \   000000DE   0xD305             BCC.N    ??search_addr_sd_9
    512                {
    513                  flag_err_sd=SDERR_ReadOverTime;
   \   000000E0   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   000000E4   0x2103             MOVS     R1,#+3
   \   000000E6   0x7001             STRB     R1,[R0, #+0]
    514                  flag_yes=0; //³¬Ê±³ö´í
   \   000000E8   0x2400             MOVS     R4,#+0
   \   000000EA   0xE018             B.N      ??search_addr_sd_10
    515                }
    516               else if(DBUF[0]!=0xeb||DBUF[1]!=0x58||DBUF[2]!=0x90)
   \                     ??search_addr_sd_9:
   \   000000EC   0x.... 0x....      LDR.W    R0,??DataTable12
   \   000000F0   0x7800             LDRB     R0,[R0, #+0]
   \   000000F2   0x28EB             CMP      R0,#+235
   \   000000F4   0xD109             BNE.N    ??search_addr_sd_11
   \   000000F6   0x.... 0x....      LDR.W    R0,??DataTable12
   \   000000FA   0x7840             LDRB     R0,[R0, #+1]
   \   000000FC   0x2858             CMP      R0,#+88
   \   000000FE   0xD104             BNE.N    ??search_addr_sd_11
   \   00000100   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000104   0x7880             LDRB     R0,[R0, #+2]
   \   00000106   0x2890             CMP      R0,#+144
   \   00000108   0xD009             BEQ.N    ??search_addr_sd_10
    517                {
    518                  flag_err_sd=SDERR_StartSector;
   \                     ??search_addr_sd_11:
   \   0000010A   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   0000010E   0x2104             MOVS     R1,#+4
   \   00000110   0x7001             STRB     R1,[R0, #+0]
    519                  flag_yes=0; //Æô¶¯ÉÈÇø³ö´í
   \   00000112   0x2400             MOVS     R4,#+0
   \   00000114   0xE003             B.N      ??search_addr_sd_10
    520                }
    521             }
    522            else
    523             {
    524               add_sta=0;
   \                     ??search_addr_sd_5:
   \   00000116   0x.... 0x....      LDR.W    R0,??DataTable13_8
   \   0000011A   0x2100             MOVS     R1,#+0
   \   0000011C   0x6001             STR      R1,[R0, #+0]
    525             }
    526            
    527            sector_cluster=DBUF[13];    //¶ÁÈ¡Ã¿´Ø¶ÔÓ¦µÄÉÈÇøÊý
   \                     ??search_addr_sd_10:
   \   0000011E   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000122   0x7B40             LDRB     R0,[R0, #+13]
   \   00000124   0x....             LDR.N    R1,??DataTable9_5
   \   00000126   0x7008             STRB     R0,[R1, #+0]
    528            sector_sta=DBUF[14]+((dword_sd)DBUF[15]<<8);   //¼ÆËãÆô¶¯ÉÈÇøÊý
   \   00000128   0x.... 0x....      LDR.W    R0,??DataTable12
   \   0000012C   0x7B80             LDRB     R0,[R0, #+14]
   \   0000012E   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000132   0x7BC9             LDRB     R1,[R1, #+15]
   \   00000134   0x0209             LSLS     R1,R1,#+8
   \   00000136   0x1808             ADDS     R0,R1,R0
   \   00000138   0x.... 0x....      LDR.W    R1,??DataTable13_9
   \   0000013C   0x6008             STR      R0,[R1, #+0]
    529            sector_fat=DBUF[36]+((dword_sd)DBUF[37]<<8)+((dword_sd)DBUF[38]<<16)+((dword_sd)DBUF[39]<<24);
   \   0000013E   0x.... 0x....      LDR.W    R0,??DataTable12
   \   00000142   0xF890 0x0024      LDRB     R0,[R0, #+36]
   \   00000146   0x.... 0x....      LDR.W    R1,??DataTable12
   \   0000014A   0xF891 0x1025      LDRB     R1,[R1, #+37]
   \   0000014E   0x0209             LSLS     R1,R1,#+8
   \   00000150   0x1808             ADDS     R0,R1,R0
   \   00000152   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000156   0xF891 0x1026      LDRB     R1,[R1, #+38]
   \   0000015A   0xEB10 0x4001      ADDS     R0,R0,R1, LSL #+16
   \   0000015E   0x.... 0x....      LDR.W    R1,??DataTable12
   \   00000162   0xF891 0x1027      LDRB     R1,[R1, #+39]
   \   00000166   0xEB10 0x6001      ADDS     R0,R0,R1, LSL #+24
   \   0000016A   0x.... 0x....      LDR.W    R1,??DataTable13_10
   \   0000016E   0x6008             STR      R0,[R1, #+0]
    530           //¼ÆËãfat±íËùÕ¼µÄÉÈÇøÊý 
    531              
    532           //¼ÆËã¸ùÄ¿Â¼,Êý¾ÝÉÈÇø,fat1ºÍfat2µÄÊ×µØÖ· 
    533            add_f1=add_sta+sector_sta;
   \   00000170   0x.... 0x....      LDR.W    R0,??DataTable13_8
   \   00000174   0x6800             LDR      R0,[R0, #+0]
   \   00000176   0x.... 0x....      LDR.W    R1,??DataTable13_9
   \   0000017A   0x6809             LDR      R1,[R1, #+0]
   \   0000017C   0x1808             ADDS     R0,R1,R0
   \   0000017E   0x.... 0x....      LDR.W    R1,??DataTable13_3
   \   00000182   0x6008             STR      R0,[R1, #+0]
    534            add_f2=add_f1+sector_fat;
   \   00000184   0x.... 0x....      LDR.W    R0,??DataTable13_3
   \   00000188   0x6800             LDR      R0,[R0, #+0]
   \   0000018A   0x.... 0x....      LDR.W    R1,??DataTable13_10
   \   0000018E   0x6809             LDR      R1,[R1, #+0]
   \   00000190   0x1808             ADDS     R0,R1,R0
   \   00000192   0x.... 0x....      LDR.W    R1,??DataTable13_1
   \   00000196   0x6008             STR      R0,[R1, #+0]
    535            add_dir=add_f2+sector_fat;
   \   00000198   0x.... 0x....      LDR.W    R0,??DataTable13_1
   \   0000019C   0x6800             LDR      R0,[R0, #+0]
   \   0000019E   0x.... 0x....      LDR.W    R1,??DataTable13_10
   \   000001A2   0x6809             LDR      R1,[R1, #+0]
   \   000001A4   0x1808             ADDS     R0,R1,R0
   \   000001A6   0x....             LDR.N    R1,??DataTable9_1
   \   000001A8   0x6008             STR      R0,[R1, #+0]
    536            
    537            if(flag_yes==0) CloseSD();
   \   000001AA   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   000001AC   0x2C00             CMP      R4,#+0
   \   000001AE   0xD101             BNE.N    ??search_addr_sd_12
   \   000001B0   0x.... 0x....      BL       CloseSD
    538          }
   \                     ??search_addr_sd_12:
   \   000001B4   0xBD31             POP      {R0,R4,R5,PC}    ;; return
    539          /*
    540          º¯ÊýÃû³Æ£ºsearch_fat
    541          º¯Êý¹¦ÄÜ£ºËÑÑ°fat±í,ÕÒµ½×ã¹»¶àµÄ¿ÕÏÐÉÈÇø
    542          ±à Ð´ Õß£ºSword
    543          */

   \                                 In section .text, align 4, keep-with-next
    544          void search_fat(void)
    545          {
   \                     search_fat:
   \   00000000   0xE92D 0x47F0      PUSH     {R4-R10,LR}
    546            byte_sd retry,r1,num,flag,flag_over=0;
   \   00000004   0x2400             MOVS     R4,#+0
    547            dword_sd i,j,k;   
    548            
    549            for(i=k=num=flag=0,j=12;i<10000;i++,j=0)
   \   00000006   0x2600             MOVS     R6,#+0
   \   00000008   0x0035             MOVS     R5,R6
   \   0000000A   0x46B0             MOV      R8,R6
   \   0000000C   0xFA5F 0xF888      UXTB     R8,R8            ;; ZeroExt  R8,R8,#+24,#+24
   \   00000010   0x4647             MOV      R7,R8
   \   00000012   0xF05F 0x090C      MOVS     R9,#+12
   \   00000016   0xE003             B.N      ??search_fat_0
   \                     ??search_fat_1:
   \   00000018   0xF118 0x0801      ADDS     R8,R8,#+1
   \   0000001C   0xF05F 0x0900      MOVS     R9,#+0
   \                     ??search_fat_0:
   \   00000020   0xF242 0x7010      MOVW     R0,#+10000
   \   00000024   0x4580             CMP      R8,R0
   \   00000026   0xF080 0x8099      BCS.W    ??search_fat_2
    550             {    //×î¶àÑ°ÕÒ10000¸öÉÈÇø
    551          //10000¸öÉÈÇø¶ÔÓ¦Ô¼1280000¸ö´Ø,°´Ò»´Ø4KËã,ÔòÎª5GµÄ¿Õ¼ä
    552               retry=0;
   \   0000002A   0xF05F 0x0A00      MOVS     R10,#+0
    553               do
    554                {
    555                  r1=sd_readsingleblock(DBUF,add_f1+i);
   \                     ??search_fat_3:
   \   0000002E   0x.... 0x....      LDR.W    R0,??DataTable13_3
   \   00000032   0x6800             LDR      R0,[R0, #+0]
   \   00000034   0xEB18 0x0100      ADDS     R1,R8,R0
   \   00000038   0x....             LDR.N    R0,??DataTable12
   \   0000003A   0x.... 0x....      BL       sd_readsingleblock
    556                  C_WDOG();
   \   0000003E   0xB672             CPSID i          
   \   00000040   0x....             LDR.N    R1,??DataTable9_2  ;; 0x4005200c
   \   00000042   0xF24A 0x6202      MOVW     R2,#+42498
   \   00000046   0x800A             STRH     R2,[R1, #+0]
   \   00000048   0x....             LDR.N    R1,??DataTable9_2  ;; 0x4005200c
   \   0000004A   0xF24B 0x4280      MOVW     R2,#+46208
   \   0000004E   0x800A             STRH     R2,[R1, #+0]
   \   00000050   0x....             LDR.N    R1,??DataTable9_3
   \   00000052   0x7809             LDRB     R1,[R1, #+0]
   \   00000054   0x2900             CMP      R1,#+0
   \   00000056   0xD000             BEQ.N    ??search_fat_4
   \   00000058   0xB662             CPSIE i          
    557                  retry++;
   \                     ??search_fat_4:
   \   0000005A   0xF11A 0x0A01      ADDS     R10,R10,#+1
    558                } while(r1!=0x00&&retry<100);
   \   0000005E   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000060   0x2800             CMP      R0,#+0
   \   00000062   0xD004             BEQ.N    ??search_fat_5
   \   00000064   0xFA5F 0xFA8A      UXTB     R10,R10          ;; ZeroExt  R10,R10,#+24,#+24
   \   00000068   0xF1BA 0x0F64      CMP      R10,#+100
   \   0000006C   0xD3DF             BCC.N    ??search_fat_3
    559               
    560               if(retry>=100) 
   \                     ??search_fat_5:
   \   0000006E   0xFA5F 0xFA8A      UXTB     R10,R10          ;; ZeroExt  R10,R10,#+24,#+24
   \   00000072   0xF1BA 0x0F64      CMP      R10,#+100
   \   00000076   0xD306             BCC.N    ??search_fat_6
    561                {
    562                  flag_err_sd=SDERR_ReadOverTime;
   \   00000078   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   0000007C   0x2103             MOVS     R1,#+3
   \   0000007E   0x7001             STRB     R1,[R0, #+0]
    563                  break; //³¬Ê±³ö´í
   \   00000080   0xE06C             B.N      ??search_fat_2
    564                }
    565               for(;j<512;j+=4)
   \                     ??search_fat_7:
   \   00000082   0xF119 0x0904      ADDS     R9,R9,#+4
   \                     ??search_fat_6:
   \   00000086   0xF44F 0x7000      MOV      R0,#+512
   \   0000008A   0x4581             CMP      R9,R0
   \   0000008C   0xD262             BCS.N    ??search_fat_8
    566                {
    567                  if(DBUF[j]==0x00&&DBUF[j+1]==0x00&&DBUF[j+2]==0x00&&DBUF[j+3]==0x00) 
   \   0000008E   0x....             LDR.N    R0,??DataTable12
   \   00000090   0xF819 0x0000      LDRB     R0,[R9, R0]
   \   00000094   0x2800             CMP      R0,#+0
   \   00000096   0xD135             BNE.N    ??search_fat_9
   \   00000098   0x....             LDR.N    R0,??DataTable12
   \   0000009A   0xEB19 0x0000      ADDS     R0,R9,R0
   \   0000009E   0x7840             LDRB     R0,[R0, #+1]
   \   000000A0   0x2800             CMP      R0,#+0
   \   000000A2   0xD12F             BNE.N    ??search_fat_9
   \   000000A4   0x....             LDR.N    R0,??DataTable12
   \   000000A6   0xEB19 0x0000      ADDS     R0,R9,R0
   \   000000AA   0x7880             LDRB     R0,[R0, #+2]
   \   000000AC   0x2800             CMP      R0,#+0
   \   000000AE   0xD129             BNE.N    ??search_fat_9
   \   000000B0   0x....             LDR.N    R0,??DataTable12
   \   000000B2   0xEB19 0x0000      ADDS     R0,R9,R0
   \   000000B6   0x78C0             LDRB     R0,[R0, #+3]
   \   000000B8   0x2800             CMP      R0,#+0
   \   000000BA   0xD123             BNE.N    ??search_fat_9
    568                   {       //±ê¼Ç¿ÉÓÃ´Ø
    569                     if(flag==0)
   \   000000BC   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   000000BE   0x2D00             CMP      R5,#+0
   \   000000C0   0xD109             BNE.N    ??search_fat_10
    570                      {         //Ò»¶Î¿ÉÓÃ´ØµÄµÚÒ»¸ö
    571                        next_cluster[k]=((i<<7)+(j>>2));
   \   000000C2   0xEA5F 0x0099      LSRS     R0,R9,#+2
   \   000000C6   0xEB10 0x10C8      ADDS     R0,R0,R8, LSL #+7
   \   000000CA   0x....             LDR.N    R1,??DataTable12_1
   \   000000CC   0xF841 0x0027      STR      R0,[R1, R7, LSL #+2]
    572                        num=flag=1;
   \   000000D0   0x2601             MOVS     R6,#+1
   \   000000D2   0x0035             MOVS     R5,R6
   \   000000D4   0xE00E             B.N      ??search_fat_11
    573                      }
    574                     else
    575                      {     //¼ÇÂ¼¸Ã¶Î´ØµÄ¸öÊý
    576                        num++;
   \                     ??search_fat_10:
   \   000000D6   0x1C76             ADDS     R6,R6,#+1
    577                        if(num==250)
   \   000000D8   0xB2F6             UXTB     R6,R6            ;; ZeroExt  R6,R6,#+24,#+24
   \   000000DA   0x2EFA             CMP      R6,#+250
   \   000000DC   0xD10A             BNE.N    ??search_fat_11
    578                         {       //·ÀÖ¹Ò»¶Î´ØÌ«³¤±äÁ¿Òç³ö
    579                           next_cluster[k]|=(((dword_sd)num)<<24L);
   \   000000DE   0x....             LDR.N    R0,??DataTable12_1
   \   000000E0   0xF850 0x0027      LDR      R0,[R0, R7, LSL #+2]
   \   000000E4   0xB2F6             UXTB     R6,R6            ;; ZeroExt  R6,R6,#+24,#+24
   \   000000E6   0xEA50 0x6006      ORRS     R0,R0,R6, LSL #+24
   \   000000EA   0x....             LDR.N    R1,??DataTable12_1
   \   000000EC   0xF841 0x0027      STR      R0,[R1, R7, LSL #+2]
    580                           k++;flag=0;
   \   000000F0   0x1C7F             ADDS     R7,R7,#+1
   \   000000F2   0x2500             MOVS     R5,#+0
    581                         }
    582                      }
    583                     cluster_number++; 
   \                     ??search_fat_11:
   \   000000F4   0x.... 0x....      LDR.W    R0,??DataTable13_6
   \   000000F8   0x8800             LDRH     R0,[R0, #+0]
   \   000000FA   0x1C40             ADDS     R0,R0,#+1
   \   000000FC   0x.... 0x....      LDR.W    R1,??DataTable13_6
   \   00000100   0x8008             STRH     R0,[R1, #+0]
   \   00000102   0xE00D             B.N      ??search_fat_12
    584                   }
    585                  else
    586                   {
    587                     if(flag==1)
   \                     ??search_fat_9:
   \   00000104   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   00000106   0x2D01             CMP      R5,#+1
   \   00000108   0xD109             BNE.N    ??search_fat_13
    588                      {       //½«Ö¸ÕëÖ¸ÏòÏÂÒ»×é´Ø
    589                        next_cluster[k]|=(((dword_sd)num)<<24L);
   \   0000010A   0x....             LDR.N    R0,??DataTable12_1
   \   0000010C   0xF850 0x0027      LDR      R0,[R0, R7, LSL #+2]
   \   00000110   0xB2F6             UXTB     R6,R6            ;; ZeroExt  R6,R6,#+24,#+24
   \   00000112   0xEA50 0x6006      ORRS     R0,R0,R6, LSL #+24
   \   00000116   0x....             LDR.N    R1,??DataTable12_1
   \   00000118   0xF841 0x0027      STR      R0,[R1, R7, LSL #+2]
    590                        k++;
   \   0000011C   0x1C7F             ADDS     R7,R7,#+1
    591                      }
    592                     flag=0;
   \                     ??search_fat_13:
   \   0000011E   0x2500             MOVS     R5,#+0
    593                   }
    594                  if(cluster_number==SD_MAX_cluster||k==SD_MAX_segment) 
   \                     ??search_fat_12:
   \   00000120   0x.... 0x....      LDR.W    R0,??DataTable13_6
   \   00000124   0x8800             LDRH     R0,[R0, #+0]
   \   00000126   0xF240 0x31B6      MOVW     R1,#+950
   \   0000012A   0x4288             CMP      R0,R1
   \   0000012C   0xD001             BEQ.N    ??search_fat_14
   \   0000012E   0x2F28             CMP      R7,#+40
   \   00000130   0xD1A7             BNE.N    ??search_fat_7
    595                   {  //ÒÑÕÒµ½×ã¹»¶àµÄ¿ÉÓÃ´Ø»òÊý×é´æÂú
    596                     if(cluster_number==SD_MAX_cluster)
   \                     ??search_fat_14:
   \   00000132   0x.... 0x....      LDR.W    R0,??DataTable13_6
   \   00000136   0x8800             LDRH     R0,[R0, #+0]
   \   00000138   0xF240 0x31B6      MOVW     R1,#+950
   \   0000013C   0x4288             CMP      R0,R1
   \   0000013E   0xD108             BNE.N    ??search_fat_15
    597                      {
    598                        next_cluster[k]|=(((dword_sd)num)<<24L);
   \   00000140   0x....             LDR.N    R0,??DataTable12_1
   \   00000142   0xF850 0x0027      LDR      R0,[R0, R7, LSL #+2]
   \   00000146   0xB2F6             UXTB     R6,R6            ;; ZeroExt  R6,R6,#+24,#+24
   \   00000148   0xEA50 0x6006      ORRS     R0,R0,R6, LSL #+24
   \   0000014C   0x....             LDR.N    R1,??DataTable12_1
   \   0000014E   0xF841 0x0027      STR      R0,[R1, R7, LSL #+2]
    599                      }
    600                     flag_over=1;
   \                     ??search_fat_15:
   \   00000152   0x2401             MOVS     R4,#+1
    601                     break;
    602                   } 
    603                }
    604               
    605               if(flag_over) break; 
   \                     ??search_fat_8:
   \   00000154   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000156   0x2C00             CMP      R4,#+0
   \   00000158   0xF43F 0xAF5E      BEQ.W    ??search_fat_1
    606             }
    607            if(cluster_number<SD_MAX_cluster) 
   \                     ??search_fat_2:
   \   0000015C   0x.... 0x....      LDR.W    R0,??DataTable13_6
   \   00000160   0x8800             LDRH     R0,[R0, #+0]
   \   00000162   0xF240 0x31B6      MOVW     R1,#+950
   \   00000166   0x4288             CMP      R0,R1
   \   00000168   0xD214             BCS.N    ??search_fat_16
    608             {
    609               if(flag_err_sd!=SDERR_ReadOverTime)
   \   0000016A   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   0000016E   0x7800             LDRB     R0,[R0, #+0]
   \   00000170   0x2803             CMP      R0,#+3
   \   00000172   0xD003             BEQ.N    ??search_fat_17
    610                 flag_err_sd=SDERR_NoCluster;
   \   00000174   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   00000178   0x2105             MOVS     R1,#+5
   \   0000017A   0x7001             STRB     R1,[R0, #+0]
    611               if(cluster_number==0||flag_err_sd==SDERR_ReadOverTime)
   \                     ??search_fat_17:
   \   0000017C   0x.... 0x....      LDR.W    R0,??DataTable13_6
   \   00000180   0x8800             LDRH     R0,[R0, #+0]
   \   00000182   0x2800             CMP      R0,#+0
   \   00000184   0xD004             BEQ.N    ??search_fat_18
   \   00000186   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   0000018A   0x7800             LDRB     R0,[R0, #+0]
   \   0000018C   0x2803             CMP      R0,#+3
   \   0000018E   0xD101             BNE.N    ??search_fat_16
    612                { //Èç¹û´ØÊý²»¹»µ«²¢²»ÊÇÒ»¸ö´Ø¶¼Ã»ÕÒµ½µÄ»°Ôò¼ÌÐøÐ´¿¨
    613                  CloseSD(); //Ã»ÓÐÕÒµ½ÓÐÓÃ´Ø»ò¶ÁÈ¡³¬Ê±Ôò¹Ø±ÕSPI 
   \                     ??search_fat_18:
   \   00000190   0x.... 0x....      BL       CloseSD
    614                }
    615             }
    616          }
   \                     ??search_fat_16:
   \   00000194   0xE8BD 0x87F0      POP      {R4-R10,PC}      ;; return
    617          /*
    618          º¯ÊýÃû³Æ£ºfat32_init
    619          º¯Êý¹¦ÄÜ£ºfat32ÎÄ¼þÏµÍ³µÄ³õÊ¼»¯
    620          ±à Ð´ Õß£ºSword
    621          */

   \                                 In section .text, align 2, keep-with-next
    622          void fat32_init(void)
    623          {
   \                     fat32_init:
   \   00000000   0xB580             PUSH     {R7,LR}
    624            search_addr_sd();
   \   00000002   0x.... 0x....      BL       search_addr_sd
    625            if(sd_yes)
   \   00000006   0x.... 0x....      LDR.W    R0,??DataTable13_11
   \   0000000A   0x7800             LDRB     R0,[R0, #+0]
   \   0000000C   0x2800             CMP      R0,#+0
   \   0000000E   0xD02B             BEQ.N    ??fat32_init_0
    626             {
    627               SetSD_High();
   \   00000010   0x.... 0x....      BL       SetSD_High
    628               search_fat(); 
   \   00000014   0x.... 0x....      BL       search_fat
    629            
    630               if(sd_yes==1)
   \   00000018   0x.... 0x....      LDR.W    R0,??DataTable13_11
   \   0000001C   0x7800             LDRB     R0,[R0, #+0]
   \   0000001E   0x2801             CMP      R0,#+1
   \   00000020   0xD122             BNE.N    ??fat32_init_0
    631                {
    632                  p_datasector=add_dir+((dword_sd)((next_cluster[0]&0x00FFFFFF)-2))*sector_cluster; 
   \   00000022   0x....             LDR.N    R0,??DataTable9_1
   \   00000024   0x6800             LDR      R0,[R0, #+0]
   \   00000026   0x....             LDR.N    R1,??DataTable12_1
   \   00000028   0x6809             LDR      R1,[R1, #+0]
   \   0000002A   0x0209             LSLS     R1,R1,#+8        ;; ZeroExtS R1,R1,#+8,#+8
   \   0000002C   0x0A09             LSRS     R1,R1,#+8
   \   0000002E   0x1E89             SUBS     R1,R1,#+2
   \   00000030   0x....             LDR.N    R2,??DataTable9_5
   \   00000032   0x7812             LDRB     R2,[R2, #+0]
   \   00000034   0xFB02 0x0001      MLA      R0,R2,R1,R0
   \   00000038   0x....             LDR.N    R1,??DataTable10
   \   0000003A   0x6008             STR      R0,[R1, #+0]
    633                //×¢Òâ,Êý¾ÝÇøÊÇ´ÓµÚ¶þ´Ø¿ªÊ¼µÄ,ËùÒÔÒª¼õ2  
    634                  p_sector=0;
   \   0000003C   0x....             LDR.N    R0,??DataTable12_5
   \   0000003E   0x2100             MOVS     R1,#+0
   \   00000040   0x8001             STRH     R1,[R0, #+0]
    635                  ram_number=cnt_cluster=0;
   \   00000042   0x2000             MOVS     R0,#+0
   \   00000044   0x....             LDR.N    R1,??DataTable12_4
   \   00000046   0x8008             STRH     R0,[R1, #+0]
   \   00000048   0x....             LDR.N    R1,??DataTable12_3
   \   0000004A   0x8008             STRH     R0,[R1, #+0]
    636                  p_segcluster=p_cluster=0;
   \   0000004C   0x2000             MOVS     R0,#+0
   \   0000004E   0x.... 0x....      LDR.W    R1,??DataTable13_4
   \   00000052   0x7008             STRB     R0,[R1, #+0]
   \   00000054   0x.... 0x....      LDR.W    R1,??DataTable13_5
   \   00000058   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000005A   0x8008             STRH     R0,[R1, #+0]
    637                  num_segcluster=(next_cluster[0]&0xFF000000)>>24;
   \   0000005C   0x....             LDR.N    R0,??DataTable12_1
   \   0000005E   0x6800             LDR      R0,[R0, #+0]
   \   00000060   0x0E00             LSRS     R0,R0,#+24
   \   00000062   0x.... 0x....      LDR.W    R1,??DataTable13
   \   00000066   0x7008             STRB     R0,[R1, #+0]
    638                }
    639             }
    640          }
   \                     ??fat32_init_0:
   \   00000068   0xBD01             POP      {R0,PC}          ;; return
    641          /*
    642          º¯ÊýÃû³Æ£ºSD_System_Init
    643          º¯Êý¹¦ÄÜ£ºSD¿¨¼´Õû¸öÎÄ¼þÏµÍ³µÄ³õÊ¼»¯
    644                    (Ö÷º¯ÊýÖÐÖ±½Óµ÷ÓÃ¸Ãº¯Êý¾Í¿ÉÍê³É¶ÔSD¿¨È«²¿µÄ³õÊ¼»¯¹¤×÷)
    645          ±à Ð´ Õß£ºSword
    646          */

   \                                 In section .text, align 4, keep-with-next
    647          void SD_System_Init(void)
    648          {
   \                     SD_System_Init:
   \   00000000   0xB510             PUSH     {R4,LR}
    649            byte_sd retry=10;
   \   00000002   0x240A             MOVS     R4,#+10
    650          
    651            sd_yes=1;      //Ä¬ÈÏSD¿¨ÒÑ¾ÍÐ÷,Èç¹û³öÎÊÌâ,ºóÃæÖ´ÐÐCloseSD()Ê±»áÇåÁã¸Ã±äÁ¿
   \   00000004   0x.... 0x....      LDR.W    R0,??DataTable13_11
   \   00000008   0x2101             MOVS     R1,#+1
   \   0000000A   0x7001             STRB     R1,[R0, #+0]
    652            Flag_SDRdy=1;  //½«SD¿¨µÄ×´Ì¬±ê¼ÇÎª¿ÉÓÃ
   \   0000000C   0x.... 0x....      LDR.W    R0,??DataTable13_12
   \   00000010   0x2101             MOVS     R1,#+1
   \   00000012   0x7001             STRB     R1,[R0, #+0]
    653            flag_err_sd=SD_Normal;
   \   00000014   0x.... 0x....      LDR.W    R0,??DataTable13_7
   \   00000018   0x2100             MOVS     R1,#+0
   \   0000001A   0x7001             STRB     R1,[R0, #+0]
    654            SD_driver_Init();
   \   0000001C   0x.... 0x....      BL       SD_driver_Init
    655            SetSD_Low();
   \   00000020   0x.... 0x....      BL       SetSD_Low
   \   00000024   0xE011             B.N      ??SD_System_Init_0
    656            while(sd_init()&&retry!=0) 
    657             {
    658               retry--;
   \                     ??SD_System_Init_1:
   \   00000026   0x1E64             SUBS     R4,R4,#+1
    659               C_WDOG();
   \   00000028   0xB672             CPSID i          
   \   0000002A   0x.... 0x....      LDR.W    R0,??DataTable13_13  ;; 0x4005200c
   \   0000002E   0xF24A 0x6102      MOVW     R1,#+42498
   \   00000032   0x8001             STRH     R1,[R0, #+0]
   \   00000034   0x.... 0x....      LDR.W    R0,??DataTable13_13  ;; 0x4005200c
   \   00000038   0xF24B 0x4180      MOVW     R1,#+46208
   \   0000003C   0x8001             STRH     R1,[R0, #+0]
   \   0000003E   0x.... 0x....      LDR.W    R0,??DataTable13_14
   \   00000042   0x7800             LDRB     R0,[R0, #+0]
   \   00000044   0x2800             CMP      R0,#+0
   \   00000046   0xD000             BEQ.N    ??SD_System_Init_0
   \   00000048   0xB662             CPSIE i          
    660             }
   \                     ??SD_System_Init_0:
   \   0000004A   0x.... 0x....      BL       sd_init
   \   0000004E   0x2800             CMP      R0,#+0
   \   00000050   0xD002             BEQ.N    ??SD_System_Init_2
   \   00000052   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000054   0x2C00             CMP      R4,#+0
   \   00000056   0xD1E6             BNE.N    ??SD_System_Init_1
    661          
    662            if(retry==0)         //Èç¹ûsd¿¨³õÊ¼»¯³¬Ê±²»³É¹¦£¬Ôò¹Ø±Õspi 
   \                     ??SD_System_Init_2:
   \   00000058   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000005A   0x2C00             CMP      R4,#+0
   \   0000005C   0xD102             BNE.N    ??SD_System_Init_3
    663             {
    664               CloseSD();
   \   0000005E   0x.... 0x....      BL       CloseSD
   \   00000062   0xE00F             B.N      ??SD_System_Init_4
    665             }
    666            else          
    667             {
    668               flag_err_sd=SD_Normal;
   \                     ??SD_System_Init_3:
   \   00000064   0x....             LDR.N    R0,??DataTable13_7
   \   00000066   0x2100             MOVS     R1,#+0
   \   00000068   0x7001             STRB     R1,[R0, #+0]
    669               fat32_init(); //ÎÄ¼þÏµÍ³µÄ³õÊ¼»¯
   \   0000006A   0x.... 0x....      BL       fat32_init
    670               
    671             #ifdef EN_SDbuf   //³õÊ¼»¯µÚ¶þ»º´æ
    672             #ifdef EN_Cnt_SDbuf  
    673               Cnt_SDbufS1=0;
    674               Cnt_SDbufS2=0;
    675               Cnt_SDbufS3=0;
    676               Cnt_SDbufS4=0;
    677               Cnt_SDbufS5=0;
    678             #endif
    679               Stat_SDbuf=0;
   \   0000006E   0x.... 0x....      LDR.W    R0,??DataTable13_15
   \   00000072   0x2100             MOVS     R1,#+0
   \   00000074   0x7001             STRB     R1,[R0, #+0]
    680               pBuf_Now=DBUF; //Éè¶¨»º´æÖ¸ÕëµÄ³õÊ¼Öµ
   \   00000076   0x.... 0x....      LDR.W    R0,??DataTable13_16
   \   0000007A   0x....             LDR.N    R1,??DataTable12
   \   0000007C   0x6001             STR      R1,[R0, #+0]
    681               pBuf_2=DBUF2;
   \   0000007E   0x....             LDR.N    R0,??DataTable13_17
   \   00000080   0x....             LDR.N    R1,??DataTable13_18
   \   00000082   0x6001             STR      R1,[R0, #+0]
    682             #endif
    683             }
    684            
    685            sd_initover = 1;
   \                     ??SD_System_Init_4:
   \   00000084   0x....             LDR.N    R0,??DataTable13_14
   \   00000086   0x2101             MOVS     R1,#+1
   \   00000088   0x7001             STRB     R1,[R0, #+0]
    686          }
   \   0000008A   0xBD10             POP      {R4,PC}          ;; return
    687          /*
    688          º¯ÊýÃû³Æ£ºSD_System_Init_Ext
    689          º¯Êý¹¦ÄÜ£ºÀ©Õ¹°æµÄSD¿¨ÏµÍ³³õÊ¼»¯º¯Êý
    690                    (ÔÊÐíÔÚ³õÊ¼»¯Ê±Ô¤ÏÈÐ´Èë²¿·ÖÊý¾Ý)
    691          Èë¿Ú²ÎÊý£ºpbuf:³õÊ¼Êý¾ÝÖ¸Õë
    692                   len:Êý¾Ý³¤¶È
    693          ±à Ð´ Õß£ºSword
    694          */

   \                                 In section .text, align 2, keep-with-next
    695          void SD_System_Init_Ext(byte_sd * pbuf , word_sd len)
    696          {
   \                     SD_System_Init_Ext:
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    697          	word_sd i;
    698          	
    699          	SD_System_Init();
   \   00000006   0x.... 0x....      BL       SD_System_Init
    700          	
    701          	if(sd_yes != 0)
   \   0000000A   0x....             LDR.N    R0,??DataTable13_11
   \   0000000C   0x7800             LDRB     R0,[R0, #+0]
   \   0000000E   0x2800             CMP      R0,#+0
   \   00000010   0xD010             BEQ.N    ??SD_System_Init_Ext_0
    702          	{
    703          		sd_initover = 0;
   \   00000012   0x....             LDR.N    R0,??DataTable13_14
   \   00000014   0x2100             MOVS     R1,#+0
   \   00000016   0x7001             STRB     R1,[R0, #+0]
    704          		
    705          		for(i=0;i<len;i++)
   \   00000018   0x2600             MOVS     R6,#+0
   \   0000001A   0xE004             B.N      ??SD_System_Init_Ext_1
    706          		{
    707          			writebyte_ram(*pbuf++);
   \                     ??SD_System_Init_Ext_2:
   \   0000001C   0x7820             LDRB     R0,[R4, #+0]
   \   0000001E   0x.... 0x....      BL       writebyte_ram
   \   00000022   0x1C64             ADDS     R4,R4,#+1
    708          		}
   \   00000024   0x1C76             ADDS     R6,R6,#+1
   \                     ??SD_System_Init_Ext_1:
   \   00000026   0xB2B6             UXTH     R6,R6            ;; ZeroExt  R6,R6,#+16,#+16
   \   00000028   0xB2AD             UXTH     R5,R5            ;; ZeroExt  R5,R5,#+16,#+16
   \   0000002A   0x42AE             CMP      R6,R5
   \   0000002C   0xD3F6             BCC.N    ??SD_System_Init_Ext_2
    709          		
    710          		sd_initover = 1;
   \   0000002E   0x....             LDR.N    R0,??DataTable13_14
   \   00000030   0x2101             MOVS     R1,#+1
   \   00000032   0x7001             STRB     R1,[R0, #+0]
    711          	}
    712          }
   \                     ??SD_System_Init_Ext_0:
   \   00000034   0xBD70             POP      {R4-R6,PC}       ;; return
    713          /*
    714          º¯ÊýÃû³Æ£ºtest_sd
    715          º¯Êý¹¦ÄÜ£º²âÊÔSD¿¨
    716          ±à Ð´ Õß£ºSword
    717          */

   \                                 In section .text, align 2, keep-with-next
    718          void test_sd(void)
    719          {
   \                     test_sd:
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0xB08E             SUB      SP,SP,#+56
    720            byte_sd const str[]="If you see these words, your SD and hardware is OK!";
   \   00000004   0xA800             ADD      R0,SP,#+0
   \   00000006   0x....             LDR.N    R1,??DataTable13_19
   \   00000008   0x2234             MOVS     R2,#+52
   \   0000000A   0x.... 0x....      BL       __aeabi_memcpy4
    721            word_sd i;
    722            if(sd_yes)
   \   0000000E   0x....             LDR.N    R0,??DataTable13_11
   \   00000010   0x7800             LDRB     R0,[R0, #+0]
   \   00000012   0x2800             CMP      R0,#+0
   \   00000014   0xD01D             BEQ.N    ??test_sd_0
    723             { 
    724               file_name[0]='T';
   \   00000016   0x....             LDR.N    R0,??DataTable13_20
   \   00000018   0x2154             MOVS     R1,#+84
   \   0000001A   0x7001             STRB     R1,[R0, #+0]
    725               file_name[1]='E';
   \   0000001C   0x....             LDR.N    R0,??DataTable13_20
   \   0000001E   0x2145             MOVS     R1,#+69
   \   00000020   0x7041             STRB     R1,[R0, #+1]
    726               file_name[2]='S';
   \   00000022   0x....             LDR.N    R0,??DataTable13_20
   \   00000024   0x2153             MOVS     R1,#+83
   \   00000026   0x7081             STRB     R1,[R0, #+2]
    727               file_name[3]='T';
   \   00000028   0x....             LDR.N    R0,??DataTable13_20
   \   0000002A   0x2154             MOVS     R1,#+84
   \   0000002C   0x70C1             STRB     R1,[R0, #+3]
    728               file_name[4]='-';
   \   0000002E   0x....             LDR.N    R0,??DataTable13_20
   \   00000030   0x212D             MOVS     R1,#+45
   \   00000032   0x7101             STRB     R1,[R0, #+4]
    729               
    730               for(i=0;str[i]!='\0';i++)
   \   00000034   0x2400             MOVS     R4,#+0
   \   00000036   0xE005             B.N      ??test_sd_1
    731                 writebyte_ram(str[i]);
   \                     ??test_sd_2:
   \   00000038   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   0000003A   0xA800             ADD      R0,SP,#+0
   \   0000003C   0x5C20             LDRB     R0,[R4, R0]
   \   0000003E   0x.... 0x....      BL       writebyte_ram
   \   00000042   0x1C64             ADDS     R4,R4,#+1
   \                     ??test_sd_1:
   \   00000044   0xB2A4             UXTH     R4,R4            ;; ZeroExt  R4,R4,#+16,#+16
   \   00000046   0xA800             ADD      R0,SP,#+0
   \   00000048   0x5C20             LDRB     R0,[R4, R0]
   \   0000004A   0x2800             CMP      R0,#+0
   \   0000004C   0xD1F4             BNE.N    ??test_sd_2
    732                      
    733               write_stop();
   \   0000004E   0x.... 0x....      BL       write_stop
    734             }
    735          }
   \                     ??test_sd_0:
   \   00000052   0xB00E             ADD      SP,SP,#+56
   \   00000054   0xBD10             POP      {R4,PC}          ;; return
    736          

   \                                 In section .text, align 2, keep-with-next
    737          void write_SD(void)
    738          {
   \                     write_SD:
   \   00000000   0xB510             PUSH     {R4,LR}
    739            int i;
    740            writebyte_ram('U');
   \   00000002   0x2055             MOVS     R0,#+85
   \   00000004   0x.... 0x....      BL       writebyte_ram
    741            writebyte_ram('Z');
   \   00000008   0x205A             MOVS     R0,#+90
   \   0000000A   0x.... 0x....      BL       writebyte_ram
    742            for(i=0;i<128;i++)
   \   0000000E   0x2400             MOVS     R4,#+0
   \   00000010   0xE00E             B.N      ??write_SD_0
    743            {
    744              writebyte_ram(' ');
   \                     ??write_SD_1:
   \   00000012   0x2020             MOVS     R0,#+32
   \   00000014   0x.... 0x....      BL       writebyte_ram
    745              writebyte_ram('0');
   \   00000018   0x2030             MOVS     R0,#+48
   \   0000001A   0x.... 0x....      BL       writebyte_ram
    746              writebyte_ram(MAIN_CCD.ccd_value[i]+48);
   \   0000001E   0x....             LDR.N    R0,??DataTable13_21
   \   00000020   0x1820             ADDS     R0,R4,R0
   \   00000022   0xF890 0x0178      LDRB     R0,[R0, #+376]
   \   00000026   0x3030             ADDS     R0,R0,#+48
   \   00000028   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000002A   0x.... 0x....      BL       writebyte_ram
    747            }
   \   0000002E   0x1C64             ADDS     R4,R4,#+1
   \                     ??write_SD_0:
   \   00000030   0x2C80             CMP      R4,#+128
   \   00000032   0xDBEE             BLT.N    ??write_SD_1
    748            writebyte_ram(' ');
   \   00000034   0x2020             MOVS     R0,#+32
   \   00000036   0x.... 0x....      BL       writebyte_ram
    749            //±äÁ¿1
    750            writebyte_ram(Bend_L_Num/100+65);
   \   0000003A   0x....             LDR.N    R0,??DataTable13_22
   \   0000003C   0x8800             LDRH     R0,[R0, #+0]
   \   0000003E   0x2164             MOVS     R1,#+100
   \   00000040   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   00000044   0x3041             ADDS     R0,R0,#+65
   \   00000046   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000048   0x.... 0x....      BL       writebyte_ram
    751            writebyte_ram(Bend_L_Num%100+65);
   \   0000004C   0x....             LDR.N    R0,??DataTable13_22
   \   0000004E   0x8800             LDRH     R0,[R0, #+0]
   \   00000050   0x2164             MOVS     R1,#+100
   \   00000052   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000056   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   0000005A   0x3041             ADDS     R0,R0,#+65
   \   0000005C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000005E   0x.... 0x....      BL       writebyte_ram
    752            writebyte_ram(' ');
   \   00000062   0x2020             MOVS     R0,#+32
   \   00000064   0x.... 0x....      BL       writebyte_ram
    753            //±äÁ¿2
    754            writebyte_ram(Bend_L_Num/100+65);
   \   00000068   0x....             LDR.N    R0,??DataTable13_22
   \   0000006A   0x8800             LDRH     R0,[R0, #+0]
   \   0000006C   0x2164             MOVS     R1,#+100
   \   0000006E   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   00000072   0x3041             ADDS     R0,R0,#+65
   \   00000074   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000076   0x.... 0x....      BL       writebyte_ram
    755            writebyte_ram(Bend_L_Num%100+65);
   \   0000007A   0x....             LDR.N    R0,??DataTable13_22
   \   0000007C   0x8800             LDRH     R0,[R0, #+0]
   \   0000007E   0x2164             MOVS     R1,#+100
   \   00000080   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000084   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000088   0x3041             ADDS     R0,R0,#+65
   \   0000008A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000008C   0x.... 0x....      BL       writebyte_ram
    756            writebyte_ram(' ');
   \   00000090   0x2020             MOVS     R0,#+32
   \   00000092   0x.... 0x....      BL       writebyte_ram
    757            //±äÁ¿3
    758            writebyte_ram(Black_Tip_Flag/100+65);
   \   00000096   0x....             LDR.N    R0,??DataTable13_23
   \   00000098   0x7800             LDRB     R0,[R0, #+0]
   \   0000009A   0x2164             MOVS     R1,#+100
   \   0000009C   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   000000A0   0x3041             ADDS     R0,R0,#+65
   \   000000A2   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000A4   0x.... 0x....      BL       writebyte_ram
    759            writebyte_ram(Black_Tip_Flag%100+65);
   \   000000A8   0x....             LDR.N    R0,??DataTable13_23
   \   000000AA   0x7800             LDRB     R0,[R0, #+0]
   \   000000AC   0x2164             MOVS     R1,#+100
   \   000000AE   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   000000B2   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   000000B6   0x3041             ADDS     R0,R0,#+65
   \   000000B8   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000BA   0x.... 0x....      BL       writebyte_ram
    760            writebyte_ram(' ');
   \   000000BE   0x2020             MOVS     R0,#+32
   \   000000C0   0x.... 0x....      BL       writebyte_ram
    761            //±äÁ¿4
    762            writebyte_ram(ResureTip_Flag/100+65);
   \   000000C4   0x....             LDR.N    R0,??DataTable13_24
   \   000000C6   0x7800             LDRB     R0,[R0, #+0]
   \   000000C8   0x2164             MOVS     R1,#+100
   \   000000CA   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   000000CE   0x3041             ADDS     R0,R0,#+65
   \   000000D0   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000D2   0x.... 0x....      BL       writebyte_ram
    763            writebyte_ram(ResureTip_Flag%100+65);
   \   000000D6   0x....             LDR.N    R0,??DataTable13_24
   \   000000D8   0x7800             LDRB     R0,[R0, #+0]
   \   000000DA   0x2164             MOVS     R1,#+100
   \   000000DC   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   000000E0   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   000000E4   0x3041             ADDS     R0,R0,#+65
   \   000000E6   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000000E8   0x.... 0x....      BL       writebyte_ram
    764            writebyte_ram(' ');
   \   000000EC   0x2020             MOVS     R0,#+32
   \   000000EE   0x.... 0x....      BL       writebyte_ram
    765            //±äÁ¿5
    766            writebyte_ram(MAIN_CCD.Black_TO_White[1]/100+65);
   \   000000F2   0x....             LDR.N    R0,??DataTable13_21
   \   000000F4   0xF890 0x01F9      LDRB     R0,[R0, #+505]
   \   000000F8   0x2164             MOVS     R1,#+100
   \   000000FA   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   000000FE   0x3041             ADDS     R0,R0,#+65
   \   00000100   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000102   0x.... 0x....      BL       writebyte_ram
    767            writebyte_ram(MAIN_CCD.Black_TO_White[1]%100+65);
   \   00000106   0x....             LDR.N    R0,??DataTable13_21
   \   00000108   0xF890 0x01F9      LDRB     R0,[R0, #+505]
   \   0000010C   0x2164             MOVS     R1,#+100
   \   0000010E   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000112   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000116   0x3041             ADDS     R0,R0,#+65
   \   00000118   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000011A   0x.... 0x....      BL       writebyte_ram
    768            writebyte_ram(' ');
   \   0000011E   0x2020             MOVS     R0,#+32
   \   00000120   0x.... 0x....      BL       writebyte_ram
    769            //±äÁ¿6
    770            writebyte_ram(MAIN_CCD.White_TO_Black[0]/100+65);
   \   00000124   0x....             LDR.N    R0,??DataTable13_21
   \   00000126   0xF890 0x01FC      LDRB     R0,[R0, #+508]
   \   0000012A   0x2164             MOVS     R1,#+100
   \   0000012C   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   00000130   0x3041             ADDS     R0,R0,#+65
   \   00000132   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000134   0x.... 0x....      BL       writebyte_ram
    771            writebyte_ram(MAIN_CCD.White_TO_Black[0]%100+65);
   \   00000138   0x....             LDR.N    R0,??DataTable13_21
   \   0000013A   0xF890 0x01FC      LDRB     R0,[R0, #+508]
   \   0000013E   0x2164             MOVS     R1,#+100
   \   00000140   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000144   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000148   0x3041             ADDS     R0,R0,#+65
   \   0000014A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000014C   0x.... 0x....      BL       writebyte_ram
    772            writebyte_ram(' ');
   \   00000150   0x2020             MOVS     R0,#+32
   \   00000152   0x.... 0x....      BL       writebyte_ram
    773            //±äÁ¿7
    774            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   00000156   0x....             LDR.N    R0,??DataTable13_21
   \   00000158   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   0000015C   0x2164             MOVS     R1,#+100
   \   0000015E   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   00000162   0x3041             ADDS     R0,R0,#+65
   \   00000164   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000166   0x.... 0x....      BL       writebyte_ram
    775            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   0000016A   0x....             LDR.N    R0,??DataTable13_21
   \   0000016C   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   00000170   0x2164             MOVS     R1,#+100
   \   00000172   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000176   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   0000017A   0x3041             ADDS     R0,R0,#+65
   \   0000017C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000017E   0x.... 0x....      BL       writebyte_ram
    776            writebyte_ram(' ');
   \   00000182   0x2020             MOVS     R0,#+32
   \   00000184   0x.... 0x....      BL       writebyte_ram
    777            //±äÁ¿8
    778            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   00000188   0x....             LDR.N    R0,??DataTable13_21
   \   0000018A   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   0000018E   0x2164             MOVS     R1,#+100
   \   00000190   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   00000194   0x3041             ADDS     R0,R0,#+65
   \   00000196   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000198   0x.... 0x....      BL       writebyte_ram
    779            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   0000019C   0x....             LDR.N    R0,??DataTable13_21
   \   0000019E   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   000001A2   0x2164             MOVS     R1,#+100
   \   000001A4   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   000001A8   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   000001AC   0x3041             ADDS     R0,R0,#+65
   \   000001AE   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000001B0   0x.... 0x....      BL       writebyte_ram
    780            writebyte_ram(' ');
   \   000001B4   0x2020             MOVS     R0,#+32
   \   000001B6   0x.... 0x....      BL       writebyte_ram
    781            //±äÁ¿9
    782            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   000001BA   0x....             LDR.N    R0,??DataTable13_21
   \   000001BC   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   000001C0   0x2164             MOVS     R1,#+100
   \   000001C2   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   000001C6   0x3041             ADDS     R0,R0,#+65
   \   000001C8   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000001CA   0x.... 0x....      BL       writebyte_ram
    783            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   000001CE   0x....             LDR.N    R0,??DataTable13_21
   \   000001D0   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   000001D4   0x2164             MOVS     R1,#+100
   \   000001D6   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   000001DA   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   000001DE   0x3041             ADDS     R0,R0,#+65
   \   000001E0   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000001E2   0x.... 0x....      BL       writebyte_ram
    784            writebyte_ram(' ');
   \   000001E6   0x2020             MOVS     R0,#+32
   \   000001E8   0x.... 0x....      BL       writebyte_ram
    785            //±äÁ¿10
    786            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   000001EC   0x....             LDR.N    R0,??DataTable13_21
   \   000001EE   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   000001F2   0x2164             MOVS     R1,#+100
   \   000001F4   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   000001F8   0x3041             ADDS     R0,R0,#+65
   \   000001FA   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   000001FC   0x.... 0x....      BL       writebyte_ram
    787            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   00000200   0x....             LDR.N    R0,??DataTable13_21
   \   00000202   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   00000206   0x2164             MOVS     R1,#+100
   \   00000208   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   0000020C   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000210   0x3041             ADDS     R0,R0,#+65
   \   00000212   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000214   0x.... 0x....      BL       writebyte_ram
    788            writebyte_ram(' ');
   \   00000218   0x2020             MOVS     R0,#+32
   \   0000021A   0x.... 0x....      BL       writebyte_ram
    789            //±äÁ¿11
    790            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   0000021E   0x....             LDR.N    R0,??DataTable13_21
   \   00000220   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   00000224   0x2164             MOVS     R1,#+100
   \   00000226   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   0000022A   0x3041             ADDS     R0,R0,#+65
   \   0000022C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000022E   0x.... 0x....      BL       writebyte_ram
    791            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   00000232   0x....             LDR.N    R0,??DataTable13_21
   \   00000234   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   00000238   0x2164             MOVS     R1,#+100
   \   0000023A   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   0000023E   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000242   0x3041             ADDS     R0,R0,#+65
   \   00000244   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000246   0x.... 0x....      BL       writebyte_ram
    792            writebyte_ram(' ');
   \   0000024A   0x2020             MOVS     R0,#+32
   \   0000024C   0x.... 0x....      BL       writebyte_ram
    793            //±äÁ¿12
    794            writebyte_ram(MAIN_CCD.Black_Position/100+65);
   \   00000250   0x....             LDR.N    R0,??DataTable13_21
   \   00000252   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   00000256   0x2164             MOVS     R1,#+100
   \   00000258   0xFB90 0xF0F1      SDIV     R0,R0,R1
   \   0000025C   0x3041             ADDS     R0,R0,#+65
   \   0000025E   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000260   0x.... 0x....      BL       writebyte_ram
    795            writebyte_ram(MAIN_CCD.Black_Position%100+65);
   \   00000264   0x....             LDR.N    R0,??DataTable13_21
   \   00000266   0xF9B0 0x020C      LDRSH    R0,[R0, #+524]
   \   0000026A   0x2164             MOVS     R1,#+100
   \   0000026C   0xFB90 0xF2F1      SDIV     R2,R0,R1
   \   00000270   0xFB01 0x0012      MLS      R0,R1,R2,R0
   \   00000274   0x3041             ADDS     R0,R0,#+65
   \   00000276   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000278   0x.... 0x....      BL       writebyte_ram
    796            writebyte_ram(' ');
   \   0000027C   0x2020             MOVS     R0,#+32
   \   0000027E   0x.... 0x....      BL       writebyte_ram
    797          }
   \   00000282   0xBD10             POP      {R4,PC}          ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7:
   \   00000000   0x........         DC32     Flag_SDRdy

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_1:
   \   00000000   0x........         DC32     Stat_SDbuf

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_2:
   \   00000000   0x........         DC32     pBuf_2

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_3:
   \   00000000   0x........         DC32     Sector_SDbuf

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_4:
   \   00000000   0x001E8480         DC32     0x1e8480

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9:
   \   00000000   0x........         DC32     pBuf_Now

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9_1:
   \   00000000   0x........         DC32     add_dir

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9_2:
   \   00000000   0x4005200C         DC32     0x4005200c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9_3:
   \   00000000   0x........         DC32     sd_initover

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9_4:
   \   00000000   0x........         DC32     dir_sd

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable9_5:
   \   00000000   0x........         DC32     sector_cluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable10:
   \   00000000   0x........         DC32     p_datasector

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable11:
   \   00000000   0x........         DC32     file_name

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12:
   \   00000000   0x........         DC32     DBUF

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_1:
   \   00000000   0x........         DC32     next_cluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_2:
   \   00000000   0x........         DC32     file_property

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_3:
   \   00000000   0x........         DC32     ram_number

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_4:
   \   00000000   0x........         DC32     cnt_cluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_5:
   \   00000000   0x........         DC32     p_sector

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable12_6:
   \   00000000   0x........         DC32     file_size

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13:
   \   00000000   0x........         DC32     num_segcluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_1:
   \   00000000   0x........         DC32     add_f2

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_2:
   \   00000000   0x........         DC32     DBUF

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_3:
   \   00000000   0x........         DC32     add_f1

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_4:
   \   00000000   0x........         DC32     p_cluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_5:
   \   00000000   0x........         DC32     p_segcluster

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_6:
   \   00000000   0x........         DC32     cluster_number

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_7:
   \   00000000   0x........         DC32     flag_err_sd

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_8:
   \   00000000   0x........         DC32     add_sta

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_9:
   \   00000000   0x........         DC32     sector_sta

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_10:
   \   00000000   0x........         DC32     sector_fat

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_11:
   \   00000000   0x........         DC32     sd_yes

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_12:
   \   00000000   0x........         DC32     Flag_SDRdy

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_13:
   \   00000000   0x4005200C         DC32     0x4005200c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_14:
   \   00000000   0x........         DC32     sd_initover

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_15:
   \   00000000   0x........         DC32     Stat_SDbuf

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_16:
   \   00000000   0x........         DC32     pBuf_Now

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_17:
   \   00000000   0x........         DC32     pBuf_2

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_18:
   \   00000000   0x........         DC32     DBUF2

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_19:
   \   00000000   0x........         DC32     `?<Constant "If you see these word...">`

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_20:
   \   00000000   0x........         DC32     file_name

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_21:
   \   00000000   0x........         DC32     MAIN_CCD

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_22:
   \   00000000   0x........         DC32     Bend_L_Num

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_23:
   \   00000000   0x........         DC32     Black_Tip_Flag

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable13_24:
   \   00000000   0x........         DC32     ResureTip_Flag

   \                                 In section .rodata, align 4
   \                     `?<Constant "If you see these word...">`:
   \   00000000   0x49 0x66          DC8 49H, 66H, 20H, 79H, 6FH, 75H, 20H, 73H
   \              0x20 0x79    
   \              0x6F 0x75    
   \              0x20 0x73    
   \   00000008   0x65 0x65          DC8 65H, 65H, 20H, 74H, 68H, 65H, 73H, 65H
   \              0x20 0x74    
   \              0x68 0x65    
   \              0x73 0x65    
   \   00000010   0x20 0x77          DC8 20H, 77H, 6FH, 72H, 64H, 73H, 2CH, 20H
   \              0x6F 0x72    
   \              0x64 0x73    
   \              0x2C 0x20    
   \   00000018   0x79 0x6F          DC8 79H, 6FH, 75H, 72H, 20H, 53H, 44H, 20H
   \              0x75 0x72    
   \              0x20 0x53    
   \              0x44 0x20    
   \   00000020   0x61 0x6E          DC8 61H, 6EH, 64H, 20H, 68H, 61H, 72H, 64H
   \              0x64 0x20    
   \              0x68 0x61    
   \              0x72 0x64    
   \   00000028   0x77 0x61          DC8 77H, 61H, 72H, 65H, 20H, 69H, 73H, 20H
   \              0x72 0x65    
   \              0x20 0x69    
   \              0x73 0x20    
   \   00000030   0x4F 0x4B          DC8 4FH, 4BH, 21H, 0
   \              0x21 0x00    
    798          
    799          #endif

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        8  SD_ClrBuf
              8 -> Wait_SDRdy
              8 -> sd_writesingleblock
        8  SD_System_Init
              8 -> CloseSD
              8 -> SD_driver_Init
              8 -> SetSD_Low
              8 -> fat32_init
              8 -> sd_init
       16  SD_System_Init_Ext
             16 -> SD_System_Init
             16 -> writebyte_ram
       16  SD_WriteBlock_UserBuf
             16 -> Wait_SDRdy
             16 -> sd_writesingleblock
        8  fat32_init
              8 -> SetSD_High
              8 -> search_addr_sd
              8 -> search_fat
       16  search_addr_sd
             16 -> CloseSD
             16 -> sd_readsingleblock
       32  search_fat
             32 -> CloseSD
             32 -> sd_readsingleblock
       64  test_sd
             64 -> __aeabi_memcpy4
             64 -> write_stop
             64 -> writebyte_ram
        8  write_SD
              8 -> writebyte_ram
       24  write_dir
             24 -> CloseSD
             24 -> sd_readsingleblock
             24 -> sd_writesingleblock
       32  write_fat
             32 -> sd_readsingleblock
             32 -> sd_writesingleblock
        8  write_stop
              8 -> CloseSD
              8 -> SD_ClrBuf
              8 -> Wait_SDRdy
              8 -> write_dir
              8 -> write_fat
              8 -> writeram_sd
        8  writebyte_ram
              8 -> writeram_sd
        8  writeram_sd
              8 -> SD_WriteBlock_UserBuf


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      52  ?<Constant "If you see these word...">
       4  ??DataTable10
       4  ??DataTable11
       4  ??DataTable12
       4  ??DataTable12_1
       4  ??DataTable12_2
       4  ??DataTable12_3
       4  ??DataTable12_4
       4  ??DataTable12_5
       4  ??DataTable12_6
       4  ??DataTable13
       4  ??DataTable13_1
       4  ??DataTable13_10
       4  ??DataTable13_11
       4  ??DataTable13_12
       4  ??DataTable13_13
       4  ??DataTable13_14
       4  ??DataTable13_15
       4  ??DataTable13_16
       4  ??DataTable13_17
       4  ??DataTable13_18
       4  ??DataTable13_19
       4  ??DataTable13_2
       4  ??DataTable13_20
       4  ??DataTable13_21
       4  ??DataTable13_22
       4  ??DataTable13_23
       4  ??DataTable13_24
       4  ??DataTable13_3
       4  ??DataTable13_4
       4  ??DataTable13_5
       4  ??DataTable13_6
       4  ??DataTable13_7
       4  ??DataTable13_8
       4  ??DataTable13_9
       4  ??DataTable7
       4  ??DataTable7_1
       4  ??DataTable7_2
       4  ??DataTable7_3
       4  ??DataTable7_4
       4  ??DataTable9
       4  ??DataTable9_1
       4  ??DataTable9_2
       4  ??DataTable9_3
       4  ??DataTable9_4
       4  ??DataTable9_5
     512  DBUF
     512  DBUF2
      66  SD_ClrBuf
     140  SD_System_Init
      54  SD_System_Init_Ext
     350  SD_WriteBlock_UserBuf
       4  Sector_SDbuf
       1  Stat_SDbuf
       4  add_dir
       4  add_f1
       4  add_f2
       4  add_sta
       2  cluster_number
       2  cnt_cluster
      32  dir_sd
     106  fat32_init
      12  file_name
      16  file_property
       4  file_size
     160  next_cluster
       1  num_segcluster
       4  pBuf_2
       4  pBuf_Now
       1  p_cluster
       4  p_datasector
       2  p_sector
       2  p_segcluster
       2  ram_number
     438  search_addr_sd
     408  search_fat
       1  sector_cluster
       4  sector_fat
       4  sector_sta
      86  test_sd
     644  write_SD
     990  write_dir
     656  write_fat
      68  write_stop
      74  writebyte_ram
     256  writeram_sd

 
 1 242 bytes in section .bss
    12 bytes in section .data
   100 bytes in section .rodata
 4 516 bytes in section .text
 
 4 516 bytes of CODE  memory
   100 bytes of CONST memory
 1 254 bytes of DATA  memory

Errors: none
Warnings: 1
